import qm3.mol
import qm3.fio.dcd
try:
    import cStringIO as io
except:
    import io

f = io.StringIO( """30

O      5.080   1.059   0.000
C      6.215   1.362  -0.832
C      7.412   1.682   0.049
O      8.566   1.990  -0.755
C      9.701   2.293   0.077
C     10.919   2.618  -0.771
O     12.073   2.927   0.033
C     13.209   3.230  -0.799
C     14.427   3.555   0.049
O     15.581   3.863  -0.755
C     16.717   4.166   0.077
C     17.935   4.492  -0.771
O     19.063   4.793   0.071
H     19.819   4.995  -0.503
H      5.972   2.275  -1.432
H      6.460   0.451  -1.432
H      7.645   0.775   0.649
H      7.162   2.584   0.649
H      9.935   1.388   0.677
H      9.453   3.195   0.677
H     10.680   3.514  -1.371
H     11.158   1.723  -1.371
H     12.961   4.131  -1.399
H     13.443   2.324  -1.399
H     14.666   2.660   0.649
H     14.188   4.450   0.649
H     16.951   3.261   0.677
H     16.469   5.068   0.677
H     17.702   5.400  -1.371
H     18.186   3.588  -1.371""" )

m = qm3.mol.molecule()
m.xyz_read( f )
f.close()

f = io.StringIO( """1
2 1
3 2 1
4 3 2 1
5 4 3 2
6 5 4 3
7 6 5 4
8 7 6 5
9 8 7 6
10 9 8 7
11 10 9 8
12 11 10 9
13 12 11 10
14 13 12 11
15 2 3 4
16 2 15 3
17 3 2 1
18 3 17 2
19 5 4 3
20 5 19 4
21 6 5 4
22 6 21 5
23 8 7 6
24 8 23 7
25 9 8 7
26 9 25 8
27 11 10 9
28 11 27 10
29 12 11 10
30 12 29 11""" )
c = []
for l in f:
    c.append( [ int( i ) - 1 for i in l.strip().split() ] )
f.close()

g = open( "tmp.xyz", "wt" )
m.xyz_write( g )
g.close()

f = io.StringIO()
m.zmat_write( c, f )

d = qm3.fio.dcd.dcd()
d.open_write( "tmp.dcd", m.natm )
f.seek( 0 )
print( f.read() )
for vv in [ [ 1., .0, .0 ], [ .0, 1., .0 ], [ .0, .0, 1. ], [ 1., 1., .0 ], [ 1., .0, 1. ], [ .0, 1., 1. ], [ 1., 1., 1. ] ]:
    f.seek( 0 )
    m.zmat_read( f , axis = vv )
    d.append( m )
d.close()
f.close()
