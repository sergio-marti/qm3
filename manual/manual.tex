\documentclass[10pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\geometry{verbose,portrait,paperwidth=210mm,paperheight=297mm,tmargin=10mm,bmargin=15mm,lmargin=10mm,rmargin=10mm,headheight=0mm,headsep=0mm,footskip=5mm}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{verbments}
\usepackage{fontspec}

\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

\usepackage{hyperref}
\hypersetup{colorlinks=true, linktoc=all, linkcolor=blue}

\usepackage[toc]{multitoc}
\renewcommand*{\multicolumntoc}{2}
\setlength{\columnseprule}{0.4pt}
\setlength{\columnsep}{36pt}

\usepackage{multicol}
\usepackage{verbatim}

\usepackage{longtable}

\setlength\parindent{0mm}
\pagestyle{fancy}

%\definecolor{fcol}{RGB}{128, 128, 128}
\definecolor{fcol}{RGB}{ 64,   0, 128}
\definecolor{pcol}{RGB}{ 17, 128,  48}
\definecolor{gray}{RGB}{128, 128, 128}
\newcommand{\func}[1]{\textcolor{fcol}{\textbf{\fontspec{Anonymous Pro}#1}}}
\newcommand{\parm}[1]{\textcolor{pcol}{\fontspec{Anonymous Pro}#1}}

\begin{document}
\lhead{} \chead{} \rhead{}
\lfoot{} \cfoot{} \rfoot{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\setmainfont{Candara}

\tableofcontents

\newpage

\section{qm3.maths}
\input{matrix}
\input{interpolation}
\input{grids}
\input{integration}
\input{fourier}
\input{roots}
\input{stats}
\input{ode}

\section{qm3}
\input{constants}
\input{elements}
\input{problem}
\input{mol}

\section{qm3.utils}
\input{utils}
\input{pes_samples}
\input{mpi}
\input{shm}
\input{free_energy}
\input{prepare}

\section{qm3.fio}
\input{dcd}
\input{mol2}
\input{sdf}
\input{xplor}

\section{qm3.actions}
\input{minimize}
\input{genetic}
\input{paths}
\input{dynamics}
\input{fitting}
\input{string}
\input{neb}
\input{grote_hynes}
\input{vina}
\input{rpol}

\section{qm3.engines}
\normalsize
The following strings: \textbf{qm\_job} (energy, gradient, ...), \textbf{qm3\_guess} (whether
a previous wavefunction can be read), \textbf{qm3\_atoms} (symbols and coordinates for the QM atoms) and
\textbf{qm3\_charges} (coordinates and charges of the MM atoms), are common replacements
in QM input templates. In addition, other strings can also be defined depending on a particular program,
such as \textbf{qm3\_nchg} (DFTB+: total amount of MM charges within the QM calculation)
or \textbf{qm3\_field} (Gaussian: points where calcualting the electric field generated by
the QM atoms and the wave-function).\\
The base module offers the function \func{exclusions}, which helps in defining those 
MM terms that should be added whenever a QM-MM partition (using the Link Atom approach) is performed.
\begin{pyglist}[language=python,fvset={frame=single}]
def exclusions( sele_QM, molec, bonds = None )
\end{pyglist}
Most of the engines are used as external programs by means of a single execution scheme
(thus parsing the outputs, \func{run\_single}).
In addition, some of them offer other ways of
execution, such as via pipes (\func{run\_pipe}, usually for MM programs where the
initialization is time consuming), through pipes and shared memory (\func{run\_shmem}) or directly by using
shared libraries (\func{run\_dynlib}) or programs with a python interface enabled (\func{run\_native}).
\input{mmres}
\input{metadyn}
\input{plumed}
\input{mmint}
% -- MM
\input{mol_mech}
\input{charmm}
\input{dynamo}
\input{namd}
\input{sander}
\input{lammps}
\input{openmm}
\input{gromacs}
% -- QM_semi
\input{mopac}
\input{dftb}
\input{sqm}
\input{xtb}
% -- QM_abin
\input{demon}
\input{gamess}
\input{gaussian}
\input{lsdalton}
\input{nwchem}
\input{orca}
\input{psi4}
\input{pyscf}
\input{qchem}
\input{smash}
\input{tmole}
\input{tchem}
\input{bagel}

\section{Testcase: Oxy-cope in water}
\input{oxy_cope}
\end{document}
