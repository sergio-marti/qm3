# -*- coding: iso-8859-1 -*-
import sys
import math
import qm3.actions.minimize
import qm3.problem
import qm3.maths.matrix




"""
                                Samples for PES fitting

            [http://www.originlab.com/doc/Origin-Help/Curve-Fitting-Function]


def function( x, c ):
    return( c[0] * ( 1 + c[1] * math.exp( - x / c[2] ) ) / ( 1 + c[3] * math.exp( - x / c[4] ) ) )


c[2] / c[5] can be fixed at minima

def function( x, c ):
    return( c[0] * ( 1 - math.exp( - c[1] * ( x - c[2] ) ) ** 2 + c[3] * math.exp( - c[4] * ( x - c[5] ) ** 2 ) ) )


"""


class problem( qm3.problem.template ):

    def __init__( self, x, y, ext_func, ext_parm ):
        self.efun = ext_func
        self.coor = ext_parm[:]
        self.size = len( self.coor )
        self.func = 0
        self.grad = [ 0.0 for i in range( self.size ) ]
        self.hess = None
        self.__x = x[:]
        self.__y = y[:]
        self.__n = len( self.__x )


    def get_func( self ):
        self.func = 0.0
        for i in range( self.__n ):
            self.func += math.pow( self.efun( self.__x[i], self.coor ) - self.__y[i], 2.0 )


    def get_grad( self ):
        self.get_func()
        be = self.func
        ic = 1.0e-6
        for i in range( self.size ):
            bc = self.coor[i]
            self.coor[i] += ic
            self.get_func()
            self.grad[i] = ( self.func - be ) / ic
            self.coor[i] = bc
        self.func = be
    

    def correlation( self ):
        y_m = sum( self.__y ) / float( self.__n )
        y_d = 0.0
        y_s = 0.0
        for i in range( self.__n ):
            p_v = self.__y[i] - self.efun( self.__x[i], self.coor )
            y_d += p_v * p_v
            y_s += math.pow( self.__y[i] - y_m, 2.0 )
        self.Rsq = 1.0 - y_d / y_s
        return( self.Rsq )

    
    def table( self, fname = None ):
        if( fname != None ):
            fd = open( fname, "wt" )
        else:
            fd = sys.stdout
        fd.write( "# %.10lf\n"%( self.Rsq ) )
        fd.write( "# " + str.join( " ", [ "%.10lf"%( self.coor[i] ) for i in range( self.size ) ] ) + "\n" )
        fd.write( "#%19s%20s%20s\n"%( "X", "Y", "Fitted" ) )
        for i in range( self.__n ):
            fd.write( "%20.10lf%20.10lf%20.10lf\n"%( self.__x[i], self.__y[i], self.efun( self.__x[i], self.coor ) ) )
        if( fname != None ):
            fd.close()


    def fit( self, minimize_func = None ):
        if( minimize_func != None ):
            minimize_func( self )
        else:
            qm3.actions.minimize.steepest_descent( self, step_number = 1000, print_frequency = 1000, gradient_tolerance = 100.0, step_size = 0.1 )
            qm3.actions.minimize.l_bfgs( self, step_number = 1000, print_frequency = 100, gradient_tolerance = 0.01, step_size = 0.1 )
        self.correlation()
        return( self.Rsq, self.coor )





# - Multiple Linear Regression:
# Y: [] (N)
# X: [ [x1], ..., [xk] ] (k,N)
#
# correlation (R^2)
# coefficients: [ao, a1, ..., ak]
# standard deviations for coefficients: [s(ao), s(a1), ..., s(ak)]
def MLR( x, y, normalize = False ):
    n = len( y )
    k = len( x )
    if( sum( [ len( x[i] ) for i in range( k ) ] ) != k * n ):
        raise Exception( "MLR: Invalid dimensions: X_{N,k} vs Y_{N,1}" )
    if( normalize ):
        # --------------------------------------------------------------------------------
        # Normalized X & Y: [a1, ..., ak]
        #
        my = sum( y ) / float( n )
        ny = [ float( y[i] ) - my for i in range( n ) ]
        mx = []
        for i in range( k ):
            mx.append( sum( x[i] ) / float( n ) )
        nx = []
        for j in range( k ):
            t = []
            for i in range( n ):
                t.append( float( x[j][i] ) - mx[j] )
            nx.append( t[:] )
        v = []
        for j in range( k ):
            v.append( sum( [ ny[i]*nx[j][i] for i in range( n ) ] ) )
        m = []
        for i in range( k ):
            for j in range( i, k ):
                m.append( sum( [ nx[i][l]*nx[j][l] for l in range( n ) ] ) )
        b = qm3.maths.matrix.inverse( qm3.maths.matrix.from_upper_diagonal_rows( m, k ), k, k )
        c = qm3.maths.matrix.mult( b, k, k, v, k, 1 )
        r = sum( [ ny[i]*ny[i] for i in range( n ) ] )
        t = 0.0
        for i in range( n ):
            tt = 0.0
            for j in range( k ):
                tt += nx[j][i] * c[j]
            t += ( tt - ny[i] ) * ( tt - ny[i] )
        r = 1 - t / r
        return( r, c, [ b[i*k+i] for i in range( k ) ], mx, my )
    else:
    # --------------------------------------------------------------------------------
    # UN-Normalized X & Y: [a0,a1, ..., ak]
    #
        v = [ float( sum( y ) ) ]
        for i in range( k ):
            v.append( float( sum( [ ii*jj for ii,jj in zip( y, x[i] ) ] ) ) )
        m = [ float( n ) ]
        for i in range( k ):
            m.append( float( sum( x[i] ) ) )
        for i in range( k ):
            for j in range( i, k ):
                m.append( float( sum( [ ii*jj for ii,jj in zip( x[i], x[j] ) ] ) ) )
        b = qm3.maths.matrix.inverse( qm3.maths.matrix.from_upper_diagonal_rows( m, k+1 ), k+1, k+1 )
        c = qm3.maths.matrix.mult( b, k+1, k+1, v, k+1, 1 )
        r = sum( [ (float(i)-v[0]/float(n))*(float(i)-v[0]/float(n)) for i in y ] )
        t = 0.0
        for i in range( n ):
            tt = c[0]
            for j in range( k ):
                tt += x[j][i] * c[j+1]
            t += ( tt - y[i] ) * ( tt - y[i] )
        r = 1 - t / r
        if( n > k + 1 ):
            return( r, c, [ t * b[i*(k+1)+i] / ( n - k - 1.0 ) for i in range( k+1 ) ] )
        else:
            return( r, c, None )



# - Partial Least Squares
# Y: [] (N)
# X: [ [x1], ..., [xk] ] (k,N)
#
# correlation (R^2)
# coefficients: [a1, ..., ak]
# mean-X: [ <x1>, ..., <xk> ]
# mean-Y: <y>
def PLS( x, y ):
    n = len( y )
    k = len( x )
    if( sum( [ len( i ) for i in x ] ) != k * n or len( y ) != n ):
        raise Exception( "PLS: Invalid dimensions: X_{N,k} vs Y_{N,1}" )
    mx = [ float( sum( x[i] ) ) / float( n ) for i in range( k ) ]
    nx = []
    for j in range( n ):
        for i in range( k ):
            nx.append( float( x[i][j] ) - mx[i] )
    ox = nx[:]
    my = float( sum( y ) ) / float( n )
    ny = [ float( y[i] - my ) for i in range( n ) ]
    u = ny[:]
    D = []
    C = []
    P = []
    ex = 1e9
    while( ex > 0.0001 ):
        eu = 1e9
        while( eu > 0.0001 ):
            w = qm3.maths.matrix.norm( qm3.maths.matrix.mult( qm3.maths.matrix.T( nx, n, k ), k, n, u, n, 1 ) )
            t = qm3.maths.matrix.norm( qm3.maths.matrix.mult( nx, n, k, w, k, 1 ) )
            c = sum( [ ny[i]*t[i] for i in range( n ) ] )
            c /= math.fabs( c )
            u = [ ny[i] * c for i in range( n ) ]
            eu = math.sqrt( sum( [ (ny[i]-u[i])*(ny[i]-u[i]) for i in range( n ) ] ) )
        C.append( c )
        b = sum( [ t[i]*u[i] for i in range( n )  ] )
        D.append( b )
#        _p = sum( [ t[i]*t[i] for i in range( n ) ] )
#        p = [ ii/_p for ii in qm3.maths.matrix.mult( qm3.maths.matrix.T( nx, n, k ), k, n, t, n, 1 ) ]
        p = qm3.maths.matrix.mult( qm3.maths.matrix.T( nx, n, k ), k, n, t, n, 1 )
        P += p[:]
#        q = sum( [ ny[i]*u[i] for i in range( n ) ] ) / sum( [ u[i]*u[i] for i in range( n ) ] )
        nx = [ ii-jj for ii,jj in zip( nx, qm3.maths.matrix.mult( t, n, 1, p, 1, k ) ) ]
        ny = [ ny[i]-b*t[i]*c for i in range( n ) ]
        ex = math.sqrt( sum( [ nx[i]*nx[i] for i in range( n * k ) ] ) )
    m = len( C )
    B = qm3.maths.matrix.from_diagonal( D, m )
    coef = qm3.maths.matrix.mult( qm3.maths.matrix.inverse( P, m, k ), k, m, qm3.maths.matrix.mult( B, m, m, C, m, 1 ), m, 1 )
    sr = 0.0
    sy = 0.0
    for i in range( n ):
        sy += ( y[i] - my ) * ( y[i] - my )
        yc = 0.0
        for j in range( k ):
            yc += ox[i*k+j] * coef[j]
        sr += ( yc + my - y[i] ) * ( yc + my - y[i] )
    return( 1 - sr / sy, coef, mx, my )



def poly_val( v, x ):
    return( sum( [ v[i] * math.pow( x, i ) for i in range( len( v ) ) ] ) )



#  [ a0, a1, ..., an ]  ==  a0 + a1 * x + ... + an * x^n
def poly_fit( vec_x, vec_y, order ):
    def __gen_sum( v, k ):
        return( sum( [ math.pow( v[i], k ) for i in range( len( v ) ) ] ) )

    def __gen_yxsum( vy, vx, k ):
        return( sum( [ vy[i]*math.pow( vx[i], k ) for i in range( len( vy ) ) ] ) )

    siz = len( vec_x )
    ror = order + 1
    if( siz < ror or siz != len( vec_y ) ):
        return( None )
    # Independent terms...
    ind = [ __gen_sum( vec_y, 1 ) ]
    for i in range( 1, ror ):
        ind.append( __gen_yxsum( vec_y, vec_x, i ) )
    # Matrix terms...
    t = [ siz ]
    for i in range( 1, 2 * ror - 1 ):
        t.append( __gen_sum( vec_x, i ) )
    mat = []
    for i in range( ror ):
        for j in range( ror ):
            mat.append( t[i+j] )
    sdc = qm3.maths.matrix.inverse( mat, ror, ror )
    cof = qm3.maths.matrix.mult( sdc, ror, ror, ind, ror, 1 )
    # Calculate correlation of the fit
    y_m = __gen_sum( vec_y, 1 ) / float( siz )
    y_d = 0.0
    y_s = 0.0
    for i in range( siz ):
        t = vec_y[i] - poly_val( cof, vec_x[i] )
        y_d += t * t
        y_s += ( vec_y[i] - y_m ) * ( vec_y[i] - y_m )
    return( 1.0 - y_d / y_s, cof, [ sdc[i*ror+i] for i in range( ror ) ] )



# Anal. Chem. v36, p1627 (1964) [10.1021/ac60214a047]
def savitzky_golay( x, y, points = None, gradient = False ):
    """
    Savitzky-Golay cubic smoothing

    points are the total fitting points (2 * m + 1)
    >> x values must be equally spaced!
    returns the fitted values and their first derivative (gradient == True)
    """
    n = len( x )
    if( points == None ):
        t = sorted( [ ( n >= i, i ) for i in [ 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27 ] ] )[-1]
        if( t[0] ):
            points = t[1]
            print( "\n>> Savitzky-Golay smoothing total fitting points:", points )
    m  = ( points - 1 ) // 2
    f  = None
    g  = None
    wf = None
    cf = None
    wg = None
    cg = None
    if( points == 7 and n >= 7 ):
        wf = [ 42,42,42,21,42,42,42 ]
        cf = [ [ 39,8,-4,-4,1,4,-2 ],
                [ 8,19,16,6,-4,-7,4 ],
                [ -4,16,19,12,2,-4,1 ],
                [ -2,3,6,7,6,3,-2 ],
                [ 1,-4,2,12,19,16,-4 ],
                [ 4,-7,-4,6,16,19,8 ],
                [ -2,4,1,-4,-4,8,39 ] ]
        wg = [ 252,252,252,252,252,252,252 ]
        cg = [ [ -257,122,185,72,-77,-122,77 ],
                [ -122,17,62,48,10,-17,2 ],
                [ -29,-46,-19,24,55,46,-31 ],
                [ 22,-67,-58,0,58,67,-22 ],
                [ 31,-46,-55,-24,19,46,29 ],
                [ -2,17,-10,-48,-62,-17,122 ],
                [ -77,122,77,-72,-185,-122,257 ] ]
    elif( points == 9 and n >= 9 ):
        wf = [ 99,198,1386,462,231,462,1386,198,99 ]
        cf = [ [ 85,28,-2,-12,-9,0,8,8,-7 ],
                [ 56,65,56,36,12,-9,-20,-14,16 ],
                [ -28,392,515,432,234,12,-143,-140,112 ],
                [ -56,84,144,145,108,54,4,-21,0 ],
                [ -21,14,39,54,59,54,39,14,-21 ],
                [ 0,-21,4,54,108,145,144,84,-56 ],
                [ 112,-140,-143,12,234,432,515,392,-28 ],
                [ 16,-14,-20,-9,12,36,56,65,56 ],
                [ -7,8,8,0,-9,-12,-2,28,85 ] ]
        wg = [ 8316,8316,8316,8316,1188,8316,8316,8316,8316 ]
        cg = [ [ -6118,854,3593,3366,1440,-918,-2441,-1862,2086 ],
                [ -3556,-49,1538,1737,1080,99,-674,-707,532 ],
                [ -1582,-658,29,486,720,738,547,154,-434 ],
                [ -196,-973,-934,-387,360,999,1222,721,-812 ],
                [ 86,-142,-193,-126,0,126,193,142,-86 ],
                [ 812,-721,-1222,-999,-360,387,934,973,196 ],
                [ 434,-154,-547,-738,-720,-486,-29,658,1582 ],
                [ -532,707,674,-99,-1080,-1737,-1538,49,3556 ],
                [ -2086,1862,2441,918,-1440,-3366,-3593,-854,6118 ] ]
    elif( points == 11 and n >= 11 ):
        wf = [ 143,143,429,858,429,429,429,858,429,143,143 ]
        cf = [ [ 113,48,8,-12,-17,-12,-2,8,13,8,-12 ],
                [ 48,41,32,22,12,3,-4,-8,-8,-3,8 ],
                [ 24,96,123,116,86,44,1,-32,-44,-24,39 ],
                [ -72,132,232,251,212,138,52,-23,-64,-48,48 ],
                [ -51,36,86,106,103,84,56,26,1,-12,-6 ],
                [ -36,9,44,69,84,89,84,69,44,9,-36 ],
                [ -6,-12,1,26,56,84,103,106,86,36,-51 ],
                [ 48,-48,-64,-23,52,138,212,251,232,132,-72 ],
                [ 39,-24,-44,-32,1,44,86,116,123,96,24 ],
                [ 8,-3,-8,-8,-4,3,12,22,32,41,48 ],
                [ -12,8,13,8,-2,-12,-17,-12,8,48,113 ] ]
        wg = [ 2574,5148,2574,5148,2574,5148,2574,5148,2574,5148,2574 ]
        cg = [ [ -1425,-102,589,791,647,300,-107,-431,-529,-258,525 ],
                [ -1860,-294,572,889,808,480,56,-313,-476,-282,420 ],
                [ -525,-174,49,167,203,180,121,49,-13,-42,-15 ],
                [ -420,-366,-244,-83,88,240,344,371,292,78,-300 ],
                [ 15,-174,-227,-181,-73,60,181,253,239,102,-195 ],
                [ 300,-294,-532,-503,-296,0,296,503,532,294,-300 ],
                [ 195,-102,-239,-253,-181,-60,73,181,227,174,-15 ],
                [ 300,-78,-292,-371,-344,-240,-88,83,244,366,420 ],
                [ 15,42,13,-49,-121,-180,-203,-167,-49,174,525 ],
                [ -420,282,476,313,-56,-480,-808,-889,-572,294,1860 ],
                [ -525,258,529,431,107,-300,-647,-791,-589,102,1425 ] ]
    elif( points == 13 and n >= 13 ):
        wf = [ 364,91,2002,1001,4004,1001,143,1001,4004,1001,2002,91,364 ]
        cf = [ [ 265,132,42,-12,-37,-40,-28,-8,13,28,30,12,-33 ],
                [ 33,25,18,12,7,3,0,-2,-3,-3,-2,0,3 ],
                [ 231,396,460,444,369,256,126,0,-101,-156,-144,-44,165 ],
                [ -33,132,222,251,233,182,112,37,-29,-72,-78,-33,77 ],
                [ -407,308,738,932,939,808,588,328,77,-116,-202,-132,143 ],
                [ -110,33,128,182,202,195,168,128,82,37,0,-22,-22 ],
                [ -11,0,9,16,21,24,25,24,21,16,9,0,-11 ],
                [ -22,-22,0,37,82,128,168,195,202,182,128,33,-110 ],
                [ 143,-132,-202,-116,77,328,588,808,939,932,738,308,-407 ],
                [ 77,-33,-78,-72,-29,37,112,182,233,251,222,132,-33 ],
                [ 165,-44,-144,-156,-101,0,126,256,369,444,460,396,231 ],
                [ 3,0,-2,-3,-3,-2,0,3,7,12,18,25,33 ],
                [ -33,12,30,28,13,-8,-28,-40,-37,-12,42,132,265 ] ]
        wg = [ 24024,12012,24024,12012,24024,12012,24024,12012,24024,12012,24024,12012,24024 ]
        cg = [ [ -10351,-2244,2670,4972,5243,4064,2016,-320,-2363,-3532,-3246,-924,4015 ],
                [ -3641,-990,666,1502,1693,1414,840,146,-493,-902,-906,-330,1001 ],
                [ -4675,-1716,246,1372,1823,1760,1344,736,97,-412,-630,-396,451 ],
                [ -1265,-726,-294,38,277,430,504,506,443,322,150,-66,-319 ],
                [ -847,-1188,-1170,-884,-421,128,672,1120,1381,1364,978,132,-1265 ],
                [ 187,-462,-750,-754,-551,-218,168,530,791,874,702,198,-715 ],
                [ 1133,-660,-1578,-1796,-1489,-832,0,832,1489,1796,1578,660,-1133 ],
                [ 715,-198,-702,-874,-791,-530,-168,218,551,754,750,462,-187 ],
                [ 1265,-132,-978,-1364,-1381,-1120,-672,-128,421,884,1170,1188,847 ],
                [ 319,66,-150,-322,-443,-506,-504,-430,-277,-38,294,726,1265 ],
                [ -451,396,630,412,-97,-736,-1344,-1760,-1823,-1372,-246,1716,4675 ],
                [ -1001,330,906,902,493,-146,-840,-1414,-1693,-1502,-666,990,3641 ],
                [ -4015,924,3246,3532,2363,320,-2016,-4064,-5243,-4972,-2670,2244,10351 ] ]
    elif( points == 15 and n >= 15 ):
        wf = [ 3060,21420,278460,139230,278460,278460,30940,1105,30940,278460,278460,139230,278460,21420,3060 ]
        cf = [ [ 2059,1144,484,44,-211,-316,-306,-216,-81,64,184,244,209,44,-286 ],
                [ 8008,5833,4048,2618,1508,683,108,-252,-432,-467,-392,-242,-52,143,308 ],
                [ 44044,52624,54709,51524,44294,34244,22599,10584,-576,-9656,-15431,-16676,-12166,-676,19019 ],
                [ 2002,17017,25762,29252,28502,24527,18342,10962,3402,-3323,-8198,-10208,-8338,-1573,11102 ],
                [ -19201,19604,44294,57004,59869,55024,44604,30744,15579,1244,-10126,-16396,-15431,-5096,16744 ],
                [ -28756,8879,34244,49054,55024,53869,47304,37044,24804,12299,1244,-6646,-9656,-6071,5824 ],
                [ -3094,156,2511,4076,4956,5256,5081,4536,3726,2756,1731,756,-64,-624,-819 ],
                [ -78,-13,42,87,122,147,162,167,162,147,122,87,42,-13,-78 ],
                [ -819,-624,-64,756,1731,2756,3726,4536,5081,5256,4956,4076,2511,156,-3094 ],
                [ 5824,-6071,-9656,-6646,1244,12299,24804,37044,47304,53869,55024,49054,34244,8879,-28756 ],
                [ 16744,-5096,-15431,-16396,-10126,1244,15579,30744,44604,55024,59869,57004,44294,19604,-19201 ],
                [ 11102,-1573,-8338,-10208,-8198,-3323,3402,10962,18342,24527,28502,29252,25762,17017,2002 ],
                [ 19019,-676,-12166,-16676,-15431,-9656,-576,10584,22599,34244,44294,51524,54709,52624,44044 ],
                [ 308,143,-52,-242,-392,-467,-432,-252,108,683,1508,2618,4048,5833,8008 ],
                [ -286,44,209,244,184,64,-81,-216,-306,-316,-211,44,484,1144,2059 ] ]
        wg = [ 334152,334152,334152,334152,334152,334152,334152,334152,334152,334152,334152,334152,334152,334152,334152 ]
        cg = [ [ -115115,-37154,14683,44372,55889,53210,40311,21168,-243,-19946,-33965,-38324,-29047,-2158,46319 ],
                [ -85358,-30797,6154,28106,37670,37457,30078,18144,4266,-8945,-18878,-22922,-18466,-2899,26390 ],
                [ -59423,-24986,-905,14276,22013,23762,20979,15120,7641,-2,-6353,-9956,-9355,-3094,10283 ],
                [ -37310,-19721,-6494,2882,8918,12125,13014,12096,9882,6883,3610,574,-1714,-2743,-2002 ],
                [ -19019,-15002,-10613,-6076,-1615,2546,6183,9072,10989,11710,11011,8668,4457,-1846,-10465 ],
                [ -4550,-10829,-13262,-12598,-9586,-4975,486,6048,10962,14479,15850,14326,9158,-403,-15106 ],
                [ 6097,-7202,-14441,-16684,-14995,-10438,-4077,3024,9801,15190,18127,17548,12389,1586,-15925 ],
                [ 12922,-4121,-14150,-18334,-17842,-13843,-7506,0,7506,13843,17842,18334,14150,4121,-12922 ],
                [ 15925,-1586,-12389,-17548,-18127,-15190,-9801,-3024,4077,10438,14995,16684,14441,7202,-6097 ],
                [ 15106,403,-9158,-14326,-15850,-14479,-10962,-6048,-486,4975,9586,12598,13262,10829,4550 ],
                [ 10465,1846,-4457,-8668,-11011,-11710,-10989,-9072,-6183,-2546,1615,6076,10613,15002,19019 ],
                [ 2002,2743,1714,-574,-3610,-6883,-9882,-12096,-13014,-12125,-8918,-2882,6494,19721,37310 ],
                [ -10283,3094,9355,9956,6353,2,-7641,-15120,-20979,-23762,-22013,-14276,905,24986,59423 ],
                [ -26390,2899,18466,22922,18878,8945,-4266,-18144,-30078,-37457,-37670,-28106,-6154,30797,85358 ],
                [ -46319,2158,29047,38324,33965,19946,243,-21168,-40311,-53210,-55889,-44372,-14683,37154,115115 ] ]
    elif( points == 17 and n >= 17 ):
        wf = [ 969,3876,3876,3876,1938,3876,3876,3876,323,3876,3876,3876,1938,3876,3876,3876,969 ]
        cf = [ [ 605,364,182,52,-33,-80,-96,-88,-63,-28,10,44,67,72,52,0,-91 ],
                [ 1456,1055,728,468,268,121,20,-42,-72,-77,-64,-40,-12,13,28,26,0 ],
                [ 728,728,691,624,534,428,313,196,84,-16,-97,-152,-174,-156,-91,28,208 ],
                [ 208,468,624,691,684,618,508,369,216,64,-72,-177,-236,-234,-156,13,288 ],
                [ -66,134,267,342,368,354,309,242,162,78,-1,-66,-108,-118,-87,-6,134 ],
                [ -320,121,428,618,708,715,656,548,408,253,100,-34,-132,-177,-152,-40,176 ],
                [ -384,20,313,508,618,656,635,568,468,348,221,100,-2,-72,-97,-64,40 ],
                [ -352,-42,196,369,484,548,568,551,504,434,348,253,156,64,-16,-77,-112 ],
                [ -21,-6,7,18,27,34,39,42,43,42,39,34,27,18,7,-6,-21 ],
                [ -112,-77,-16,64,156,253,348,434,504,551,568,548,484,369,196,-42,-352 ],
                [ 40,-64,-97,-72,-2,100,221,348,468,568,635,656,618,508,313,20,-384 ],
                [ 176,-40,-152,-177,-132,-34,100,253,408,548,656,715,708,618,428,121,-320 ],
                [ 134,-6,-87,-118,-108,-66,-1,78,162,242,309,354,368,342,267,134,-66 ],
                [ 288,13,-156,-234,-236,-177,-72,64,216,369,508,618,684,691,624,468,208 ],
                [ 208,28,-91,-156,-174,-152,-97,-16,84,196,313,428,534,624,691,728,728 ],
                [ 0,26,28,13,-12,-40,-64,-77,-72,-42,20,121,268,468,728,1055,1456 ],
                [ -91,0,52,72,67,44,10,-28,-63,-88,-96,-80,-33,52,182,364,605 ] ]
        wg = [ 23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256,23256 ]
        cg = [ [ -6548,-2642,125,1902,2838,3082,2783,2090,1152,118,-863,-1642,-2070,-1998,-1277,242,2708 ],
                [ -5048,-2177,-118,1233,1980,2227,2078,1637,1008,295,-398,-967,-1308,-1317,-890,77,1688 ],
                [ -3716,-1754,-319,654,1230,1474,1451,1226,864,430,-11,-394,-654,-726,-545,-46,836 ],
                [ -2552,-1373,-478,165,588,823,902,857,720,523,298,77,-108,-225,-242,-127,152 ],
                [ -1556,-1034,-595,-234,54,274,431,530,576,574,529,446,330,186,19,-166,-364 ],
                [ -728,-737,-670,-543,-372,-173,38,245,432,583,682,713,660,507,238,-163,-712 ],
                [ -68,-482,-703,-762,-690,-518,-277,2,288,550,757,878,882,738,415,-118,-892 ],
                [ 424,-269,-694,-891,-900,-761,-514,-199,144,475,754,941,996,879,550,-31,-904 ],
                [ 748,-98,-643,-930,-1002,-902,-673,-358,0,358,673,902,1002,930,643,98,-748 ],
                [ 904,31,-550,-879,-996,-941,-754,-475,-144,199,514,761,900,891,694,269,-424 ],
                [ 892,118,-415,-738,-882,-878,-757,-550,-288,-2,277,518,690,762,703,482,68 ],
                [ 712,163,-238,-507,-660,-713,-682,-583,-432,-245,-38,173,372,543,670,737,728 ],
                [ 364,166,-19,-186,-330,-446,-529,-574,-576,-530,-431,-274,-54,234,595,1034,1556 ],
                [ -152,127,242,225,108,-77,-298,-523,-720,-857,-902,-823,-588,-165,478,1373,2552 ],
                [ -836,46,545,726,654,394,11,-430,-864,-1226,-1451,-1474,-1230,-654,319,1754,3716 ],
                [ -1688,-77,890,1317,1308,967,398,-295,-1008,-1637,-2078,-2227,-1980,-1233,118,2177,5048 ],
                [ -2708,-242,1277,1998,2070,1642,863,-118,-1152,-2090,-2783,-3082,-2838,-1902,-125,2642,6548 ] ]
    elif( points == 19 and n >= 19 ):
        wf = [ 1463,4389,74613,298452,74613,21318,10659,298452,6783,2261,6783,298452,10659,21318,74613,298452,74613,4389,1463 ]
        cf = [ [ 851,544,304,124,-3,-84,-126,-136,-121,-88,-44,4,49,84,102,96,59,-16,-136 ],
                [ 1632,1193,832,542,316,147,28,-48,-88,-99,-88,-62,-28,7,36,52,48,17,-48 ],
                [ 15504,14144,12601,10924,9162,7364,5579,3856,2244,792,-451,-1436,-2114,-2436,-2353,-1816,-776,816,3009 ],
                [ 25296,36856,43696,46439,45708,42126,36316,28901,20504,11748,3256,-4349,-10444,-14406,-15612,-13439,-7264,3536,19584 ],
                [ -153,5372,9162,11427,12377,12222,11172,9437,7227,4752,2222,-153,-2163,-3598,-4248,-3903,-2353,612,5202 ],
                [ -1224,714,2104,3009,3492,3616,3444,3039,2464,1782,1056,349,-276,-756,-1028,-1029,-696,34,1224 ],
                [ -918,68,797,1297,1596,1722,1703,1567,1342,1056,737,413,112,-138,-309,-373,-302,-68,357 ],
                [ -27744,-3264,15424,28901,37748,42546,43876,42319,38456,32868,26136,18841,11564,4886,-612,-4349,-5744,-4216,816 ],
                [ -561,-136,204,466,657,784,854,874,851,792,704,594,469,336,202,74,-41,-136,-204 ],
                [ -136,-51,24,89,144,189,224,249,264,269,264,249,224,189,144,89,24,-51,-136 ],
                [ -204,-136,-41,74,202,336,469,594,704,792,851,874,854,784,657,466,204,-136,-561 ],
                [ 816,-4216,-5744,-4349,-612,4886,11564,18841,26136,32868,38456,42319,43876,42546,37748,28901,15424,-3264,-27744 ],
                [ 357,-68,-302,-373,-309,-138,112,413,737,1056,1342,1567,1703,1722,1596,1297,797,68,-918 ],
                [ 1224,34,-696,-1029,-1028,-756,-276,349,1056,1782,2464,3039,3444,3616,3492,3009,2104,714,-1224 ],
                [ 5202,612,-2353,-3903,-4248,-3598,-2163,-153,2222,4752,7227,9437,11172,12222,12377,11427,9162,5372,-153 ],
                [ 19584,3536,-7264,-13439,-15612,-14406,-10444,-4349,3256,11748,20504,28901,36316,42126,45708,46439,43696,36856,25296 ],
                [ 3009,816,-776,-1816,-2353,-2436,-2114,-1436,-451,792,2244,3856,5579,7364,9162,10924,12601,14144,15504 ],
                [ -48,17,48,52,36,7,-28,-62,-88,-99,-88,-48,28,147,316,542,832,1193,1632 ],
                [ -136,-16,59,96,102,84,49,4,-44,-88,-121,-136,-126,-84,-3,124,304,544,851 ] ]
        wg = [ 81396,1790712,127908,1790712,895356,1790712,895356,162792,895356,255816,895356,162792,895356,1790712,895356,1790712,127908,1790712,81396 ]
        cg = [ [ -19074,-8908,-1366,3853,7050,8526,8582,7519,5638,3240,626,-1903,-4046,-5502,-5970,-5149,-2738,1564,8058 ],
                [ -333336,-162724,-35032,54577,110940,138894,143276,128923,100672,63360,21824,-19099,-54572,-79758,-89820,-79921,-45224,19108,117912 ],
                [ -18258,-9452,-2774,2009,5130,6822,7318,6851,5654,3960,2002,13,-1774,-3126,-3810,-3593,-2242,476,4794 ],
                [ -186456,-104788,-41464,5413,37740,57414,66332,66391,59488,47520,32384,15977,196,-13062,-21900,-24421,-18728,-2924,24888 ],
                [ -62934,-40052,-21458,-6781,4350,12306,17458,20177,20834,19800,17446,14143,10262,6174,2250,-1139,-3622,-4828,-4386 ],
                [ -73848,-58276,-43192,-28799,-15300,-2898,8204,17803,25696,31680,35552,37109,36148,32466,25860,16127,3064,-13532,-33864 ],
                [ -15198,-19652,-21146,-20149,-17130,-12558,-6902,-631,5786,11880,17182,21223,23534,23646,21090,15397,6098,-7276,-25194 ],
                [ 408,-2108,-3656,-4369,-4380,-3822,-2828,-1531,-64,1440,2848,4027,4844,5166,4860,3793,1832,-1156,-5304 ],
                [ 15402,-4964,-18482,-26041,-28530,-26838,-21854,-14467,-5566,3960,13222,21331,27398,30534,29850,24457,13466,-4012,-28866 ],
                [ 6936,68,-4648,-7481,-8700,-8574,-7372,-5363,-2816,0,2816,5363,7372,8574,8700,7481,4648,-68,-6936 ],
                [ 28866,4012,-13466,-24457,-29850,-30534,-27398,-21331,-13222,-3960,5566,14467,21854,26838,28530,26041,18482,4964,-15402 ],
                [ 5304,1156,-1832,-3793,-4860,-5166,-4844,-4027,-2848,-1440,64,1531,2828,3822,4380,4369,3656,2108,-408 ],
                [ 25194,7276,-6098,-15397,-21090,-23646,-23534,-21223,-17182,-11880,-5786,631,6902,12558,17130,20149,21146,19652,15198 ],
                [ 33864,13532,-3064,-16127,-25860,-32466,-36148,-37109,-35552,-31680,-25696,-17803,-8204,2898,15300,28799,43192,58276,73848 ],
                [ 4386,4828,3622,1139,-2250,-6174,-10262,-14143,-17446,-19800,-20834,-20177,-17458,-12306,-4350,6781,21458,40052,62934 ],
                [ -24888,2924,18728,24421,21900,13062,-196,-15977,-32384,-47520,-59488,-66391,-66332,-57414,-37740,-5413,41464,104788,186456 ],
                [ -4794,-476,2242,3593,3810,3126,1774,-13,-2002,-3960,-5654,-6851,-7318,-6822,-5130,-2009,2774,9452,18258 ],
                [ -117912,-19108,45224,79921,89820,79758,54572,19099,-21824,-63360,-100672,-128923,-143276,-138894,-110940,-54577,35032,162724,333336 ],
                [ -8058,-1564,2738,5149,5970,5502,4046,1903,-626,-3240,-5638,-7519,-8582,-8526,-7050,-3853,1366,8908,19074 ] ]
    elif( points == 21 and n >= 21 ):
        wf = [ 10626,5313,100947,302841,605682,302841,302841,302841,605682,33649,3059,33649,605682,302841,302841,302841,605682,302841,100947,5313,10626 ]
        cf = [ [ 5781,3876,2346,1156,271,-344,-724,-904,-919,-804,-594,-324,-29,256,496,656,701,596,306,-204,-969 ],
                [ 1938,1437,1020,680,410,203,52,-50,-110,-135,-132,-108,-70,-25,20,58,82,85,60,0,-102 ],
                [ 22287,19380,16593,13940,11435,9092,6925,4948,3175,1620,297,-780,-1597,-2140,-2395,-2348,-1985,-1292,-255,1140,2907 ],
                [ 32946,38760,41820,42469,41050,37906,33380,27815,21554,14940,8316,2025,-3590,-8186,-11420,-12949,-12430,-9520,-3876,4845,16986 ],
                [ 15447,46740,68610,82100,88253,88112,82720,73120,60355,45468,29502,13500,-1495,-14440,-24292,-30008,-30545,-24860,-11910,9348,39957 ],
                [ -9804,11571,27276,37906,44056,46321,45296,41576,35756,28431,20196,11646,3376,-4019,-9944,-13804,-15004,-12949,-7044,3306,18696 ],
                [ -20634,2964,20775,33380,41360,45296,45769,43360,38650,32220,24651,16524,8420,920,-5395,-9944,-12146,-11420,-7185,1140,14136 ],
                [ -25764,-2850,14844,27815,36560,41576,43360,42409,39220,34290,28116,21195,14024,7100,920,-4019,-7220,-8186,-6420,-1425,7296 ],
                [ -52383,-12540,19050,43108,60355,71512,77300,78440,75653,69660,61182,50940,39655,28048,16840,6752,-1495,-7180,-9582,-7980,-1653 ],
                [ -2546,-855,540,1660,2526,3159,3580,3810,3870,3781,3564,3240,2830,2355,1836,1294,750,225,-260,-684,-1026 ],
                [ -171,-76,9,84,149,204,249,284,309,324,329,324,309,284,249,204,149,84,9,-76,-171 ],
                [ -1026,-684,-260,225,750,1294,1836,2355,2830,3240,3564,3781,3870,3810,3580,3159,2526,1660,540,-855,-2546 ],
                [ -1653,-7980,-9582,-7180,-1495,6752,16840,28048,39655,50940,61182,69660,75653,78440,77300,71512,60355,43108,19050,-12540,-52383 ],
                [ 7296,-1425,-6420,-8186,-7220,-4019,920,7100,14024,21195,28116,34290,39220,42409,43360,41576,36560,27815,14844,-2850,-25764 ],
                [ 14136,1140,-7185,-11420,-12146,-9944,-5395,920,8420,16524,24651,32220,38650,43360,45769,45296,41360,33380,20775,2964,-20634 ],
                [ 18696,3306,-7044,-12949,-15004,-13804,-9944,-4019,3376,11646,20196,28431,35756,41576,45296,46321,44056,37906,27276,11571,-9804 ],
                [ 39957,9348,-11910,-24860,-30545,-30008,-24292,-14440,-1495,13500,29502,45468,60355,73120,82720,88112,88253,82100,68610,46740,15447 ],
                [ 16986,4845,-3876,-9520,-12430,-12949,-11420,-8186,-3590,2025,8316,14940,21554,27815,33380,37906,41050,42469,41820,38760,32946 ],
                [ 2907,1140,-255,-1292,-1985,-2348,-2395,-2140,-1597,-780,297,1620,3175,4948,6925,9092,11435,13940,16593,19380,22287 ],
                [ -102,0,60,85,82,58,20,-25,-70,-108,-132,-135,-110,-50,52,203,410,680,1020,1437,1938 ],
                [ -969,-204,306,596,701,656,496,256,-29,-324,-594,-804,-919,-904,-724,-344,271,1156,2346,3876,5781 ] ]
        wg = [ 3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092,1817046,3634092 ]
        cg = [ [ -719625,-373008,-106644,87664,218113,292900,320222,308276,265259,199368,118800,31752,-53579,-128996,-186302,-217300,-213793,-167584,-70476,85728,309225 ],
                [ -292695,-156579,-51288,26279,79223,110645,123646,121327,106789,83133,53460,20871,-11533,-40651,-63382,-76625,-77279,-62243,-28416,27303,108015 ],
                [ -463125,-258096,-98004,21568,105037,156820,181334,182996,166223,135432,95040,49464,3121,-39572,-74198,-96340,-101581,-85504,-43692,28272,134805 ],
                [ -176415,-103911,-46464,-2653,28943,49745,61174,64651,61597,53433,41580,27459,12491,-1903,-14302,-23285,-27431,-25319,-15528,3363,32775 ],
                [ -254505,-162336,-87348,-28064,16993,49300,70334,81572,84491,80568,71280,58104,42517,25996,10018,-3940,-14401,-19888,-18924,-10032,8265 ],
                [ -84075,-60819,-40632,-23353,-8821,3125,12646,19903,25057,28269,29700,29511,27863,24917,20834,15775,9901,3373,-3648,-11001,-18525 ],
                [ -93765,-85728,-74676,-61232,-46019,-29660,-12778,4004,20063,34776,47520,57672,64609,67708,66346,59900,47747,29264,3828,-29184,-70395 ],
                [ -15675,-27303,-33792,-35821,-34069,-29215,-21938,-12917,-2831,7641,17820,27027,34583,39809,42026,40555,34717,23833,7224,-15789,-45885 ],
                [ 19095,-28272,-59988,-77936,-83999,-80060,-68002,-49708,-27061,-1944,23760,48168,69397,85564,94786,95180,84863,61952,24564,-29184,-101175 ],
                [ 28785,-3363,-25944,-40057,-46801,-47275,-42578,-33809,-22067,-8451,5940,20007,32651,42773,49274,51055,47017,36061,17088,-11001,-49305 ],
                [ 84075,10032,-43284,-78176,-96947,-101900,-95338,-79564,-56881,-29592,0,29592,56881,79564,95338,101900,96947,78176,43284,-10032,-84075 ],
                [ 49305,11001,-17088,-36061,-47017,-51055,-49274,-42773,-32651,-20007,-5940,8451,22067,33809,42578,47275,46801,40057,25944,3363,-28785 ],
                [ 101175,29184,-24564,-61952,-84863,-95180,-94786,-85564,-69397,-48168,-23760,1944,27061,49708,68002,80060,83999,77936,59988,28272,-19095 ],
                [ 45885,15789,-7224,-23833,-34717,-40555,-42026,-39809,-34583,-27027,-17820,-7641,2831,12917,21938,29215,34069,35821,33792,27303,15675 ],
                [ 70395,29184,-3828,-29264,-47747,-59900,-66346,-67708,-64609,-57672,-47520,-34776,-20063,-4004,12778,29660,46019,61232,74676,85728,93765 ],
                [ 18525,11001,3648,-3373,-9901,-15775,-20834,-24917,-27863,-29511,-29700,-28269,-25057,-19903,-12646,-3125,8821,23353,40632,60819,84075 ],
                [ -8265,10032,18924,19888,14401,3940,-10018,-25996,-42517,-58104,-71280,-80568,-84491,-81572,-70334,-49300,-16993,28064,87348,162336,254505 ],
                [ -32775,-3363,15528,25319,27431,23285,14302,1903,-12491,-27459,-41580,-53433,-61597,-64651,-61174,-49745,-28943,2653,46464,103911,176415 ],
                [ -134805,-28272,43692,85504,101581,96340,74198,39572,-3121,-49464,-95040,-135432,-166223,-182996,-181334,-156820,-105037,-21568,98004,258096,463125 ],
                [ -108015,-27303,28416,62243,77279,76625,63382,40651,11533,-20871,-53460,-83133,-106789,-121327,-123646,-110645,-79223,-26279,51288,156579,292695 ],
                [ -309225,-85728,70476,167584,213793,217300,186302,128996,53579,-31752,-118800,-199368,-265259,-308276,-320222,-292900,-218113,-87664,106644,373008,719625 ] ]
    elif( points == 23 and n >= 23 ):
        wf = [ 2990,32890,230230,23023,46046,230230,230230,16445,6578,46046,17710,805,17710,46046,6578,16445,230230,230230,46046,23023,230230,32890,2990 ]
        cf = [ [ 1527,1064,684,380,145,-28,-146,-216,-245,-240,-208,-156,-91,-20,50,112,159,184,180,140,57,-76,-266 ],
                [ 11704,8817,6384,4370,2740,1459,492,-196,-640,-875,-936,-858,-676,-425,-140,144,392,569,640,570,324,-133,-836 ],
                [ 52668,44688,37399,30780,24810,19468,14733,10584,7000,3960,1443,-572,-2106,-3180,-3815,-4032,-3852,-3296,-2385,-1140,418,2268,4389 ],
                [ 2926,3059,3078,2997,2830,2591,2294,1953,1582,1195,806,429,78,-233,-490,-679,-786,-797,-698,-475,-114,399,1078 ],
                [ 2233,3836,4962,5660,5979,5968,5676,5152,4445,3604,2678,1716,767,-120,-896,-1512,-1919,-2068,-1910,-1396,-477,896,2772 ],
                [ -2156,10213,19468,25910,29840,31559,31368,29568,26460,22345,17524,12298,6968,1835,-2800,-6636,-9372,-10707,-10340,-7970,-3296,3983,14168 ],
                [ -11242,3444,14733,22940,28380,31368,32219,31248,28770,25100,20553,15444,10088,4800,-105,-4312,-7506,-9372,-9595,-7860,-3852,2744,12243 ],
                [ -1188,-98,756,1395,1840,2112,2232,2221,2100,1890,1612,1287,936,580,240,-63,-308,-474,-540,-485,-288,72,616 ],
                [ -539,-128,200,452,635,756,822,840,817,760,676,572,455,332,210,96,-3,-80,-128,-140,-109,-28,110 ],
                [ -3696,-1225,792,2390,3604,4469,5020,5292,5320,5139,4784,4290,3692,3025,2324,1624,960,367,-120,-466,-636,-595,-308 ],
                [ -1232,-504,111,620,1030,1348,1581,1736,1820,1840,1803,1716,1586,1420,1225,1008,776,536,295,60,-162,-364,-539 ],
                [ -42,-21,-2,15,30,43,54,63,70,75,78,79,78,75,70,63,54,43,30,15,-2,-21,-42 ],
                [ -539,-364,-162,60,295,536,776,1008,1225,1420,1586,1716,1803,1840,1820,1736,1581,1348,1030,620,111,-504,-1232 ],
                [ -308,-595,-636,-466,-120,367,960,1624,2324,3025,3692,4290,4784,5139,5320,5292,5020,4469,3604,2390,792,-1225,-3696 ],
                [ 110,-28,-109,-140,-128,-80,-3,96,210,332,455,572,676,760,817,840,822,756,635,452,200,-128,-539 ],
                [ 616,72,-288,-485,-540,-474,-308,-63,240,580,936,1287,1612,1890,2100,2221,2232,2112,1840,1395,756,-98,-1188 ],
                [ 12243,2744,-3852,-7860,-9595,-9372,-7506,-4312,-105,4800,10088,15444,20553,25100,28770,31248,32219,31368,28380,22940,14733,3444,-11242 ],
                [ 14168,3983,-3296,-7970,-10340,-10707,-9372,-6636,-2800,1835,6968,12298,17524,22345,26460,29568,31368,31559,29840,25910,19468,10213,-2156 ],
                [ 2772,896,-477,-1396,-1910,-2068,-1919,-1512,-896,-120,767,1716,2678,3604,4445,5152,5676,5968,5979,5660,4962,3836,2233 ],
                [ 1078,399,-114,-475,-698,-797,-786,-679,-490,-233,78,429,806,1195,1582,1953,2294,2591,2830,2997,3078,3059,2926 ],
                [ 4389,2268,418,-1140,-2385,-3296,-3852,-4032,-3815,-3180,-2106,-572,1443,3960,7000,10584,14733,19468,24810,30780,37399,44688,52668 ],
                [ -836,-133,324,570,640,569,392,144,-140,-425,-676,-858,-936,-875,-640,-196,492,1459,2740,4370,6384,8817,11704 ],
                [ -266,-76,57,140,180,184,159,112,50,-20,-91,-156,-208,-240,-245,-216,-146,-28,145,380,684,1064,1527 ] ]
        wg = [ 1381380,106260,1381380,1381380,197340,1381380,1381380,1381380,106260,1381380,1381380,197340,1381380,1381380,106260,1381380,1381380,1381380,197340,1381380,1381380,106260,1381380 ]
        cg = [ [ -234157,-131278,-49995,11680,55735,84158,98937,102060,95515,81290,61373,37752,12415,-12650,-35455,-54012,-66333,-70430,-64315,-46000,-13497,35182,102025 ],
                [ -14938,-8575,-3522,340,3130,4967,5970,6258,5950,5165,4022,2640,1138,-365,-1750,-2898,-3690,-4007,-3730,-2740,-918,1855,5698 ],
                [ -157465,-93142,-41703,-2000,27115,46790,58173,62412,60655,54050,43745,30888,16627,2110,-11515,-23100,-31497,-35558,-34135,-26080,-10245,14518,49357 ],
                [ -123970,-76279,-37746,-7580,15010,30815,40626,45234,45430,42005,35750,27456,17914,7915,-1750,-10290,-16914,-20831,-21250,-17380,-8430,6391,27874 ],
                [ -13387,-8698,-4845,-1760,625,2378,3567,4260,4525,4430,4043,3432,2665,1810,935,108,-603,-1130,-1405,-1360,-927,-38,1375 ],
                [ -66682,-46963,-30210,-16220,-4790,4283,11202,16170,19390,21065,21398,20592,18850,16375,13370,10038,6582,3205,110,-2500,-4422,-5453,-5390 ],
                [ -42889,-34510,-26631,-19280,-12485,-6274,-675,4284,8575,12170,15041,17160,18499,19030,18725,17556,15495,12514,8585,3680,-2229,-9170,-17171 ],
                [ -22330,-23527,-23178,-21500,-18710,-15025,-10662,-5838,-770,4325,9230,13728,17602,20635,22610,23310,22518,20017,15590,9020,90,-11417,-25718 ],
                [ -385,-1078,-1527,-1760,-1805,-1690,-1443,-1092,-665,-190,305,792,1243,1630,1925,2100,2127,1978,1625,1040,195,-938,-2387 ],
                [ 9086,-5971,-16650,-23420,-26750,-27109,-24966,-20790,-15050,-8215,-754,6864,14170,20695,25970,29526,30894,29605,25190,17180,5106,-11501,-33110 ],
                [ 19943,602,-13575,-23120,-28565,-30442,-29283,-25620,-19985,-12910,-4927,3432,11635,19150,25445,29988,32247,31690,27785,20000,7803,-9338,-31955 ],
                [ 3938,815,-1518,-3140,-4130,-4567,-4530,-4098,-3350,-2365,-1222,0,1222,2365,3350,4098,4530,4567,4130,3140,1518,-815,-3938 ],
                [ 31955,9338,-7803,-20000,-27785,-31690,-32247,-29988,-25445,-19150,-11635,-3432,4927,12910,19985,25620,29283,30442,28565,23120,13575,-602,-19943 ],
                [ 33110,11501,-5106,-17180,-25190,-29605,-30894,-29526,-25970,-20695,-14170,-6864,754,8215,15050,20790,24966,27109,26750,23420,16650,5971,-9086 ],
                [ 2387,938,-195,-1040,-1625,-1978,-2127,-2100,-1925,-1630,-1243,-792,-305,190,665,1092,1443,1690,1805,1760,1527,1078,385 ],
                [ 25718,11417,-90,-9020,-15590,-20017,-22518,-23310,-22610,-20635,-17602,-13728,-9230,-4325,770,5838,10662,15025,18710,21500,23178,23527,22330 ],
                [ 17171,9170,2229,-3680,-8585,-12514,-15495,-17556,-18725,-19030,-18499,-17160,-15041,-12170,-8575,-4284,675,6274,12485,19280,26631,34510,42889 ],
                [ 5390,5453,4422,2500,-110,-3205,-6582,-10038,-13370,-16375,-18850,-20592,-21398,-21065,-19390,-16170,-11202,-4283,4790,16220,30210,46963,66682 ],
                [ -1375,38,927,1360,1405,1130,603,-108,-935,-1810,-2665,-3432,-4043,-4430,-4525,-4260,-3567,-2378,-625,1760,4845,8698,13387 ],
                [ -27874,-6391,8430,17380,21250,20831,16914,10290,1750,-7915,-17914,-27456,-35750,-42005,-45430,-45234,-40626,-30815,-15010,7580,37746,76279,123970 ],
                [ -49357,-14518,10245,26080,34135,35558,31497,23100,11515,-2110,-16627,-30888,-43745,-54050,-60655,-62412,-58173,-46790,-27115,2000,41703,93142,157465 ],
                [ -5698,-1855,918,2740,3730,4007,3690,2898,1750,365,-1138,-2640,-4022,-5165,-5950,-6258,-5970,-4967,-3130,-340,3522,8575,14938 ],
                [ -102025,-35182,13497,46000,64315,70430,66333,54012,35455,12650,-12415,-37752,-61373,-81290,-95515,-102060,-98937,-84158,-55735,-11680,49995,131278,234157 ] ]
    elif( points == 25 and n >= 25 ):
        wf = [ 2925,5850,134550,1480050,740025,1480050,1480050,493350,246675,1480050,1480050,134550,5175,134550,1480050,1480050,246675,493350,1480050,1480050,740025,1480050,134550,5850,2925 ]
        cf = [ [ 1407,1012,682,412,197,32,-88,-168,-213,-228,-218,-188,-143,-88,-28,32,87,132,162,172,157,112,32,-88,-253 ],
                [ 2024,1549,1144,804,524,299,124,-6,-96,-151,-176,-176,-156,-121,-76,-26,24,69,104,124,124,99,44,-46,-176 ],
                [ 31372,26312,21767,17712,14122,10972,8237,5892,3912,2272,947,-88,-858,-1388,-1703,-1828,-1788,-1608,-1313,-928,-478,12,517,1012,1472 ],
                [ 208472,203412,194832,183197,168972,152622,134612,115407,95472,75272,55272,35937,17732,1122,-13428,-25453,-34488,-40068,-41728,-39003,-31428,-18538,132,25047,56672 ],
                [ 49841,66286,77671,84486,87221,86366,82411,75846,67161,56846,45391,33286,21021,9086,-2029,-11834,-19839,-25554,-28489,-28154,-24059,-15714,-2629,15686,39721 ],
                [ 16192,75647,120692,152622,172732,182317,182672,175092,160872,141307,117692,91322,63492,35497,8632,-15808,-36528,-52233,-61628,-63418,-56308,-39003,-10208,31372,87032 ],
                [ -44528,31372,90607,134612,164822,182672,189597,187032,176412,159172,136747,110572,82082,52712,23897,-2928,-26328,-44868,-57113,-61628,-56978,-41728,-14443,26312,81972 ],
                [ -28336,-506,21604,38469,50564,58364,62344,62979,60744,56114,49564,41569,32604,23144,13664,4639,-3456,-10146,-14956,-17411,-17036,-13356,-5896,5819,22264 ],
                [ -17963,-4048,7172,15912,22387,26812,29402,30372,29937,28312,25712,22352,18447,14212,9862,5612,1677,-1728,-4388,-6088,-6613,-5748,-3278,1012,7337 ],
                [ -115368,-38203,24992,75272,113692,141307,159172,168342,169872,164817,154232,139172,120692,99847,77692,55282,33672,13917,-2928,-15808,-23668,-25453,-20108,-6578,16192 ],
                [ -110308,-44528,10417,55272,90782,117692,136747,148692,154272,154232,149317,140272,127842,112772,95807,77692,59172,40992,23897,8632,-4058,-13428,-18733,-19228,-14168 ],
                [ -8648,-4048,-88,3267,6052,8302,10052,11337,12192,12652,12752,12527,12012,11242,10252,9077,7752,6312,4792,3227,1652,102,-1388,-2783,-4048 ],
                [ -253,-138,-33,62,147,222,287,342,387,422,447,462,467,462,447,422,387,342,287,222,147,62,-33,-138,-253 ],
                [ -4048,-2783,-1388,102,1652,3227,4792,6312,7752,9077,10252,11242,12012,12527,12752,12652,12192,11337,10052,8302,6052,3267,-88,-4048,-8648 ],
                [ -14168,-19228,-18733,-13428,-4058,8632,23897,40992,59172,77692,95807,112772,127842,140272,149317,154232,154272,148692,136747,117692,90782,55272,10417,-44528,-110308 ],
                [ 16192,-6578,-20108,-25453,-23668,-15808,-2928,13917,33672,55282,77692,99847,120692,139172,154232,164817,169872,168342,159172,141307,113692,75272,24992,-38203,-115368 ],
                [ 7337,1012,-3278,-5748,-6613,-6088,-4388,-1728,1677,5612,9862,14212,18447,22352,25712,28312,29937,30372,29402,26812,22387,15912,7172,-4048,-17963 ],
                [ 22264,5819,-5896,-13356,-17036,-17411,-14956,-10146,-3456,4639,13664,23144,32604,41569,49564,56114,60744,62979,62344,58364,50564,38469,21604,-506,-28336 ],
                [ 81972,26312,-14443,-41728,-56978,-61628,-57113,-44868,-26328,-2928,23897,52712,82082,110572,136747,159172,176412,187032,189597,182672,164822,134612,90607,31372,-44528 ],
                [ 87032,31372,-10208,-39003,-56308,-63418,-61628,-52233,-36528,-15808,8632,35497,63492,91322,117692,141307,160872,175092,182672,182317,172732,152622,120692,75647,16192 ],
                [ 39721,15686,-2629,-15714,-24059,-28154,-28489,-25554,-19839,-11834,-2029,9086,21021,33286,45391,56846,67161,75846,82411,86366,87221,84486,77671,66286,49841 ],
                [ 56672,25047,132,-18538,-31428,-39003,-41728,-40068,-34488,-25453,-13428,1122,17732,35937,55272,75272,95472,115407,134612,152622,168972,183197,194832,203412,208472 ],
                [ 1472,1012,517,12,-478,-928,-1313,-1608,-1788,-1828,-1703,-1388,-858,-88,947,2272,3912,5892,8237,10972,14122,17712,21767,26312,31372 ],
                [ -176,-46,44,99,124,124,104,69,24,-26,-76,-121,-156,-176,-176,-151,-96,-6,124,299,524,804,1144,1549,2024 ],
                [ -253,-88,32,112,157,172,162,132,87,32,-28,-88,-143,-188,-218,-228,-213,-168,-88,32,197,412,682,1012,1407 ] ]
        wg = [ 1776060,1776060,1776060,161460,1776060,1776060,1776060,1776060,1776060,1776060,161460,1776060,1776060,1776060,161460,1776060,1776060,1776060,1776060,1776060,1776060,161460,1776060,1776060,1776060 ]
        cg = [ [ -260590,-155342,-70301,-3774,45932,80510,101653,111054,110406,101402,85735,65098,41184,15686,-9703,-33290,-53382,-68286,-76309,-75758,-64940,-42162,-5731,46046,114862 ],
                [ -219604,-133331,-63338,-8277,33200,62441,80794,89607,90228,84005,72286,56419,37752,17633,-2590,-21569,-37956,-50403,-57562,-58085,-50624,-33831,-6358,33143,86020 ],
                [ -181654,-112838,-56705,-12222,21644,45926,61657,69870,71598,67874,59731,48202,34320,19118,3629,-11114,-24078,-34230,-40537,-41966,-37484,-26058,-6655,21758,60214 ],
                [ -13340,-8533,-4582,-1419,1024,2815,4022,4713,4956,4819,4370,3677,2808,1831,814,-175,-1068,-1797,-2294,-2491,-2320,-1713,-602,1081,3404 ],
                [ -114862,-76406,-44429,-18438,2060,17558,28549,35526,38982,39410,37303,33154,27456,20702,13385,5998,-966,-7014,-11653,-14390,-14732,-12186,-6259,3542,17710 ],
                [ -86020,-60467,-38786,-20709,-5968,5705,14578,20919,24996,27077,27430,26323,24024,20801,16922,12655,8268,4029,206,-2933,-5120,-6087,-5566,-3289,1012 ],
                [ -60214,-46046,-33473,-22422,-12820,-4594,2329,8022,12558,16010,18451,19954,20592,20438,19565,18046,15954,13362,10343,6970,3316,-546,-4543,-8602,-12650 ],
                [ -37444,-33143,-28490,-23577,-18496,-13339,-8198,-3165,1668,6209,10366,14047,17160,19613,21314,22171,22092,20985,18758,15319,10576,4437,-3190,-12397,-23276 ],
                [ -17710,-21758,-23837,-24174,-22996,-20530,-17003,-12642,-7674,-2326,3175,8602,13728,18326,22169,25030,26682,26898,25451,22114,16660,8862,-1507,-14674,-30866 ],
                [ -1012,-11891,-19514,-24213,-26320,-26167,-24086,-20409,-15468,-9595,-3122,3619,10296,16577,22130,26623,29724,31101,30422,27355,21568,12729,506,-15433,-35420 ],
                [ 1150,-322,-1411,-2154,-2588,-2750,-2677,-2406,-1974,-1418,-775,-82,624,1306,1927,2450,2838,3054,3061,2822,2300,1458,259,-1334,-3358 ],
                [ 23276,3289,-11858,-22617,-29440,-32779,-33086,-30813,-26412,-20335,-13034,-4961,3432,11693,19370,26011,31164,34377,35198,33175,27856,18789,5522,-12397,-35420 ],
                [ 30866,8602,-8525,-20982,-29236,-33754,-35003,-33450,-29562,-23806,-16649,-8558,0,8558,16649,23806,29562,33450,35003,33754,29236,20982,8525,-8602,-30866 ],
                [ 35420,12397,-5522,-18789,-27856,-33175,-35198,-34377,-31164,-26011,-19370,-11693,-3432,4961,13034,20335,26412,30813,33086,32779,29440,22617,11858,-3289,-23276 ],
                [ 3358,1334,-259,-1458,-2300,-2822,-3061,-3054,-2838,-2450,-1927,-1306,-624,82,775,1418,1974,2406,2677,2750,2588,2154,1411,322,-1150 ],
                [ 35420,15433,-506,-12729,-21568,-27355,-30422,-31101,-29724,-26623,-22130,-16577,-10296,-3619,3122,9595,15468,20409,24086,26167,26320,24213,19514,11891,1012 ],
                [ 30866,14674,1507,-8862,-16660,-22114,-25451,-26898,-26682,-25030,-22169,-18326,-13728,-8602,-3175,2326,7674,12642,17003,20530,22996,24174,23837,21758,17710 ],
                [ 23276,12397,3190,-4437,-10576,-15319,-18758,-20985,-22092,-22171,-21314,-19613,-17160,-14047,-10366,-6209,-1668,3165,8198,13339,18496,23577,28490,33143,37444 ],
                [ 12650,8602,4543,546,-3316,-6970,-10343,-13362,-15954,-18046,-19565,-20438,-20592,-19954,-18451,-16010,-12558,-8022,-2329,4594,12820,22422,33473,46046,60214 ],
                [ -1012,3289,5566,6087,5120,2933,-206,-4029,-8268,-12655,-16922,-20801,-24024,-26323,-27430,-27077,-24996,-20919,-14578,-5705,5968,20709,38786,60467,86020 ],
                [ -17710,-3542,6259,12186,14732,14390,11653,7014,966,-5998,-13385,-20702,-27456,-33154,-37303,-39410,-38982,-35526,-28549,-17558,-2060,18438,44429,76406,114862 ],
                [ -3404,-1081,602,1713,2320,2491,2294,1797,1068,175,-814,-1831,-2808,-3677,-4370,-4819,-4956,-4713,-4022,-2815,-1024,1419,4582,8533,13340 ],
                [ -60214,-21758,6655,26058,37484,41966,40537,34230,24078,11114,-3629,-19118,-34320,-48202,-59731,-67874,-71598,-69870,-61657,-45926,-21644,12222,56705,112838,181654 ],
                [ -86020,-33143,6358,33831,50624,58085,57562,50403,37956,21569,2590,-17633,-37752,-56419,-72286,-84005,-90228,-89607,-80794,-62441,-33200,8277,63338,133331,219604 ],
                [ -114862,-46046,5731,42162,64940,75758,76309,68286,53382,33290,9703,-15686,-41184,-65098,-85735,-101402,-110406,-111054,-101653,-80510,-45932,3774,70301,155342,260590 ] ]
    elif( points == 27 and n >= 27 ):
        wf = [ 5481,71253,356265,237510,118755,23751,10179,712530,356265,356265,71253,142506,118755,1305,118755,142506,71253,356265,356265,712530,10179,23751,118755,237510,356265,71253,5481 ]
        cf = [ [ 2491,1840,1288,828,453,156,-70,-232,-337,-392,-404,-380,-327,-252,-162,-64,35,128,208,268,301,300,258,168,23,-184,-460 ],
                [ 23920,18583,13984,10074,6804,4125,1988,344,-856,-1661,-2120,-2282,-2196,-1911,-1476,-940,-352,239,784,1234,1540,1653,1524,1104,344,-805,-2392 ],
                [ 83720,69920,57587,46644,37014,28620,21385,15232,10084,5864,2495,-100,-1998,-3276,-4011,-4280,-4160,-3728,-3061,-2236,-1330,-420,417,1104,1564,1720,1495 ],
                [ 35880,33580,31096,28463,25716,22890,20020,17141,14288,11496,8800,6235,3836,1638,-324,-2015,-3400,-4444,-5112,-5369,-5180,-4510,-3324,-1587,736,3680,7280 ],
                [ 9815,11340,12338,12858,12949,12660,12040,11138,10003,8684,7230,5690,4113,2548,1044,-350,-1585,-2612,-3382,-3846,-3955,-3660,-2912,-1662,139,2540,5590 ],
                [ 676,1375,1908,2289,2532,2651,2660,2573,2404,2167,1876,1545,1188,819,452,101,-220,-497,-716,-863,-924,-885,-732,-451,-28,551,1300 ],
                [ -130,284,611,858,1032,1140,1189,1186,1138,1052,935,794,636,468,297,130,-26,-164,-277,-358,-400,-396,-339,-222,-38,220,559 ],
                [ -30160,3440,30464,51423,66828,77190,83020,84829,83128,78428,71240,62075,51444,39858,27828,15865,4480,-5816,-14512,-21097,-25060,-25890,-23076,-16107,-4472,12340,34840 ],
                [ -21905,-4280,10084,21432,30009,36060,39830,41564,41507,39904,37000,33040,28269,22932,17274,11540,5975,824,-3668,-7256,-9695,-10740,-10146,-7668,-3061,3920,13520 ],
                [ -25480,-8305,5864,17244,26052,32505,36820,39214,39904,39107,37040,33920,29964,25389,20412,15250,10120,5239,824,-2908,-5740,-7455,-7836,-6666,-3728,1195,8320 ],
                [ -5252,-2120,499,2640,4338,5628,6545,7124,7400,7408,7183,6760,6174,5460,4653,3788,2900,2024,1195,448,-182,-660,-951,-1020,-832,-352,455 ],
                [ -9880,-4564,-40,3741,6828,9270,11116,12415,13216,13568,13520,13121,12420,11466,10308,8995,7576,6100,4616,3173,1820,606,-420,-1209,-1712,-1880,-1664 ],
                [ -7085,-3660,-666,1918,4113,5940,7420,8574,9423,9988,10290,10350,10189,9828,9288,8590,7755,6804,5758,4638,3465,2260,1044,-162,-1337,-2460,-3510 ],
                [ -60,-35,-12,9,28,45,60,73,84,93,100,105,108,109,108,105,100,93,84,73,60,45,28,9,-12,-35,-60 ],
                [ -3510,-2460,-1337,-162,1044,2260,3465,4638,5758,6804,7755,8590,9288,9828,10189,10350,10290,9988,9423,8574,7420,5940,4113,1918,-666,-3660,-7085 ],
                [ -1664,-1880,-1712,-1209,-420,606,1820,3173,4616,6100,7576,8995,10308,11466,12420,13121,13520,13568,13216,12415,11116,9270,6828,3741,-40,-4564,-9880 ],
                [ 455,-352,-832,-1020,-951,-660,-182,448,1195,2024,2900,3788,4653,5460,6174,6760,7183,7408,7400,7124,6545,5628,4338,2640,499,-2120,-5252 ],
                [ 8320,1195,-3728,-6666,-7836,-7455,-5740,-2908,824,5239,10120,15250,20412,25389,29964,33920,37040,39107,39904,39214,36820,32505,26052,17244,5864,-8305,-25480 ],
                [ 13520,3920,-3061,-7668,-10146,-10740,-9695,-7256,-3668,824,5975,11540,17274,22932,28269,33040,37000,39904,41507,41564,39830,36060,30009,21432,10084,-4280,-21905 ],
                [ 34840,12340,-4472,-16107,-23076,-25890,-25060,-21097,-14512,-5816,4480,15865,27828,39858,51444,62075,71240,78428,83128,84829,83020,77190,66828,51423,30464,3440,-30160 ],
                [ 559,220,-38,-222,-339,-396,-400,-358,-277,-164,-26,130,297,468,636,794,935,1052,1138,1186,1189,1140,1032,858,611,284,-130 ],
                [ 1300,551,-28,-451,-732,-885,-924,-863,-716,-497,-220,101,452,819,1188,1545,1876,2167,2404,2573,2660,2651,2532,2289,1908,1375,676 ],
                [ 5590,2540,139,-1662,-2912,-3660,-3955,-3846,-3382,-2612,-1585,-350,1044,2548,4113,5690,7230,8684,10003,11138,12040,12660,12949,12858,12338,11340,9815 ],
                [ 7280,3680,736,-1587,-3324,-4510,-5180,-5369,-5112,-4444,-3400,-2015,-324,1638,3836,6235,8800,11496,14288,17141,20020,22890,25716,28463,31096,33580,35880 ],
                [ 1495,1720,1564,1104,417,-420,-1330,-2236,-3061,-3728,-4160,-4280,-4011,-3276,-1998,-100,2495,5864,10084,15232,21385,28620,37014,46644,57587,69920,83720 ],
                [ -2392,-805,344,1104,1524,1653,1540,1234,784,239,-352,-940,-1476,-1911,-2196,-2282,-2120,-1661,-856,344,1988,4125,6804,10074,13984,18583,23920 ],
                [ -460,-184,23,168,258,300,301,268,208,128,35,-64,-162,-252,-327,-380,-404,-392,-337,-232,-70,156,453,828,1288,1840,2491 ] ]
        wg = [ 2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590,4275180,2137590 ]
        cg = [ [ -274105,-171670,-87355,-19767,32487,70800,96565,111175,116023,112502,102005,85925,65655,42588,18117,-6365,-29465,-49790,-65947,-76543,-80185,-75480,-61035,-35457,2647,54670,122005 ],
                [ -468260,-297590,-156644,-43161,45120,110460,155120,181361,191444,187630,172180,147355,115416,78624,39240,-475,-38260,-71854,-98996,-117425,-124880,-119100,-97824,-58791,260,81590,187460 ],
                [ -196885,-127390,-69751,-23079,13515,40920,60025,71719,76891,76430,71225,62165,50139,36036,20745,5155,-9845,-23366,-34519,-42415,-46165,-44880,-37671,-23649,-1925,28390,68185 ],
                [ -324740,-214910,-123284,-48525,10704,55740,87920,108581,119060,120694,114820,102775,85896,65520,42984,19625,-3220,-24214,-42020,-55301,-62720,-62940,-54624,-36435,-7036,34910,90740 ],
                [ -130585,-88990,-53995,-25131,-1929,16080,29365,38395,43639,45566,44645,41345,36135,29484,21861,13735,5575,-2150,-8971,-14419,-18025,-19320,-17835,-13101,-4649,7990,25285 ],
                [ -203060,-143990,-93620,-51369,-16656,11100,32480,48065,58436,64174,65860,64075,59400,52416,43704,33845,23420,13010,3196,-5441,-12320,-16860,-18480,-16599,-10636,-10,15860 ],
                [ -75205,-56470,-40087,-25923,-13845,-3720,4585,11203,16267,19910,22265,23465,23643,22932,21465,19375,16795,13858,10697,7445,4235,1200,-1527,-3813,-5525,-6530,-6695 ],
                [ -103220,-84830,-67652,-51693,-36960,-23460,-11200,-187,9572,18070,25300,31255,35928,39312,41400,42185,41660,39818,36652,32155,26320,19140,10608,717,-10540,-23170,-37180 ],
                [ -30745,-29830,-28027,-25455,-22233,-18480,-14315,-9857,-5225,-538,4085,8525,12663,16380,19557,22075,23815,24658,24485,23177,20615,16680,11253,4215,-4553,-15170,-27755 ],
                [ -25220,-37430,-45380,-49497,-50208,-47940,-43120,-36175,-27532,-17618,-6860,4315,15480,26208,36072,44645,51500,56210,58348,57487,53200,45060,32640,15513,-6748,-34570,-68380 ],
                [ 2795,-9070,-17815,-23727,-27093,-28200,-27335,-24785,-20837,-15778,-9895,-3475,3195,9828,16137,21835,26635,30250,32393,32777,31115,27120,20505,10983,-1733,-17930,-37895 ],
                [ 30940,-1790,-26804,-44781,-56400,-62340,-63280,-59899,-52876,-42890,-30620,-16745,-1944,13104,27720,41225,52940,62186,68284,70555,68320,60900,47616,27789,740,-34210,-77740 ],
                [ 25415,5810,-9451,-20739,-28425,-32880,-34475,-33581,-30569,-25810,-19675,-12535,-4761,3276,11205,18655,25255,30634,34421,36245,35735,32520,26229,16491,2935,-14810,-37115 ],
                [ 65260,22090,-11924,-37545,-55536,-66660,-71680,-71359,-66460,-57746,-45980,-31925,-16344,0,16344,31925,45980,57746,66460,71359,71680,66660,55536,37545,11924,-22090,-65260 ],
                [ 37115,14810,-2935,-16491,-26229,-32520,-35735,-36245,-34421,-30634,-25255,-18655,-11205,-3276,4761,12535,19675,25810,30569,33581,34475,32880,28425,20739,9451,-5810,-25415 ],
                [ 77740,34210,-740,-27789,-47616,-60900,-68320,-70555,-68284,-62186,-52940,-41225,-27720,-13104,1944,16745,30620,42890,52876,59899,63280,62340,56400,44781,26804,1790,-30940 ],
                [ 37895,17930,1733,-10983,-20505,-27120,-31115,-32777,-32393,-30250,-26635,-21835,-16137,-9828,-3195,3475,9895,15778,20837,24785,27335,28200,27093,23727,17815,9070,-2795 ],
                [ 68380,34570,6748,-15513,-32640,-45060,-53200,-57487,-58348,-56210,-51500,-44645,-36072,-26208,-15480,-4315,6860,17618,27532,36175,43120,47940,50208,49497,45380,37430,25220 ],
                [ 27755,15170,4553,-4215,-11253,-16680,-20615,-23177,-24485,-24658,-23815,-22075,-19557,-16380,-12663,-8525,-4085,538,5225,9857,14315,18480,22233,25455,28027,29830,30745 ],
                [ 37180,23170,10540,-717,-10608,-19140,-26320,-32155,-36652,-39818,-41660,-42185,-41400,-39312,-35928,-31255,-25300,-18070,-9572,187,11200,23460,36960,51693,67652,84830,103220 ],
                [ 6695,6530,5525,3813,1527,-1200,-4235,-7445,-10697,-13858,-16795,-19375,-21465,-22932,-23643,-23465,-22265,-19910,-16267,-11203,-4585,3720,13845,25923,40087,56470,75205 ],
                [ -15860,10,10636,16599,18480,16860,12320,5441,-3196,-13010,-23420,-33845,-43704,-52416,-59400,-64075,-65860,-64174,-58436,-48065,-32480,-11100,16656,51369,93620,143990,203060 ],
                [ -25285,-7990,4649,13101,17835,19320,18025,14419,8971,2150,-5575,-13735,-21861,-29484,-36135,-41345,-44645,-45566,-43639,-38395,-29365,-16080,1929,25131,53995,88990,130585 ],
                [ -90740,-34910,7036,36435,54624,62940,62720,55301,42020,24214,3220,-19625,-42984,-65520,-85896,-102775,-114820,-120694,-119060,-108581,-87920,-55740,-10704,48525,123284,214910,324740 ],
                [ -68185,-28390,1925,23649,37671,44880,46165,42415,34519,23366,9845,-5155,-20745,-36036,-50139,-62165,-71225,-76430,-76891,-71719,-60025,-40920,-13515,23079,69751,127390,196885 ],
                [ -187460,-81590,-260,58791,97824,119100,124880,117425,98996,71854,38260,475,-39240,-78624,-115416,-147355,-172180,-187630,-191444,-181361,-155120,-110460,-45120,43161,156644,297590,468260 ],
                [ -122005,-54670,-2647,35457,61035,75480,80185,76543,65947,49790,29465,6365,-18117,-42588,-65655,-85925,-102005,-112502,-116023,-111175,-96565,-70800,-32487,19767,87355,171670,274105 ] ]
    elif( n >= 5 ):
        wf = [ 70,35,35,35,70 ]
        cf = [ [ 69,4,-6,4,-1 ], [ 2,27,12,-8,2 ], [ -3,12,17,12,-3 ], [ 2,-8,12,27,2 ], [ -1,4,-6,4,69 ] ]
        wg = [ 84,42,12,42,84 ]
        cg = [ [ -125,136,48,-88,29 ], [ -19,-1,12,13,-5 ], [ 1,-8,0,8,-1 ], [ 5,-13,-12,1,19 ], [ -29,88,-48,-136,125 ] ]
    if( wf != None and cf != None ):
        f = []
        for i in range( m ):
            f.append( sum( [ ii * jj for ii,jj in zip( cf[i], y[0:points] ) ] ) / wf[i] )
        for i in range( m, n - m ):
            f.append( sum( [ ii * jj for ii,jj in zip( cf[m], y[i-m:i+m+1] ) ] ) / wf[m] )
        for i in range( m+1, 2*m+1 ):
            f.append( sum( [ ii * jj for ii,jj in zip( cf[i], y[-points:] ) ] ) / wf[i] )
    if( gradient and wg != None and cg != None ):
        dx = sum( [ x[i+1] - x[i] for i in range( n - 1 ) ] ) / float( n - 1 )
        g  = []
        for i in range( m ):
            g.append( sum( [ ii * jj for ii,jj in zip( cg[i], y[0:points] ) ] ) / ( wg[i] * dx ) )
        for i in range( m, n - m ):
            g.append( sum( [ ii * jj for ii,jj in zip( cg[m], y[i-m:i+m+1] ) ] ) / ( wg[m] * dx ) )
        for i in range( m+1, 2*m+1 ):
            g.append( sum( [ ii * jj for ii,jj in zip( cg[i], y[-points:] ) ] ) / ( wg[i] * dx ) )
    return( f, g )
