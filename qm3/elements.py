# -*- coding: iso-8859-1 -*-

from __future__ import print_function, division
import sys
if( sys.version_info[0] == 2 ):
    range = xrange
import re


# g/mol
isotopes = { "2H": 2.01410, "3H": 3.01605, "13C": 13.00335, "14C": 14.00324, "15N": 15.00011, "18O": 17.99916 }


# g/mol
mass = { 0 : 1.00794, 1 : 1.00794, 2 : 4.00260, 3 : 6.94100, 4 : 9.01218, 5 : 10.8110, 6 : 12.0107, 7 : 14.0067, 8 : 15.9994, 9 : 18.9984, 10 : 20.1797,
    11 : 22.9898, 12 : 24.3050, 13 : 26.9815, 14 : 28.0855, 15 : 30.9738, 16 : 32.0650, 17 : 35.4530, 18 : 39.9480, 19 : 39.0983, 20 : 40.0780,
    21 : 44.9559, 22 : 47.8670, 23 : 50.9415, 24 : 51.9961, 25 : 54.9380, 26 : 55.8450, 27 : 58.9332, 28 : 58.6934, 29 : 63.5460, 30 : 65.3900,
    31 : 69.7230, 32 : 72.6400, 33 : 74.9216, 34 : 78.9600, 35 : 79.9040, 36 : 83.8000, 37 : 85.4678, 38 : 87.6200, 39 : 88.9059, 40 : 91.2240,
    41 : 92.9064, 42 : 95.9400, 43 : 98.9063, 44 : 101.0700, 45 : 102.9060, 46 : 106.4200, 47 : 107.8680, 48 : 112.4110, 49 : 114.8180, 50 : 118.7100,
    51 : 121.7600, 52 : 127.6000, 53 : 126.9040, 54 : 131.2930, 55 : 132.9050, 56 : 137.2370, 57 : 138.9050, 58 : 140.1160, 59 : 140.9080, 60 : 144.2400,
    61 : 146.9150, 62 : 150.3600, 63 : 151.9640, 64 : 157.2500, 65 : 158.9250, 66 : 162.5000, 67 : 164.9300, 68 : 167.2590, 69 : 168.9340, 70 : 173.0400,
    71 : 174.9670, 72 : 178.4900, 73 : 180.9480, 74 : 183.8400, 75 : 186.2070, 76 : 190.2300, 77 : 192.2170, 78 : 195.0780, 79 : 196.9670, 80 : 200.5900,
    81 : 204.3830, 82 : 207.2000, 83 : 208.9800, 84 : 208.9820, 85 : 209.9870, 86 : 222.0180, 87 : 223.0200, 88 : 226.0250, 89 : 227.0280, 90 : 232.0380,
    91 : 231.0360, 92 : 238.0290, 93 : 237.0480, 94 : 244.0640, 95 : 243.0610, 96 : 247.0700, 97 : 247.0700, 98 : 251.0800, 99 : 252.0830, 100 : 257.0950,
    101 : 258.0990, 102 : 259.1010, 103 : 262.1100, 104 : 261.1090, 105 : 262.1140, 106 : 263.1190, 107 : 262.1230, 108 : 265.1310, 109 : 266.1380 }


# Ang (van der Waals)
r_vdw = { 0: 1.10, 1: 1.10, 2: 1.40, 3: 1.81, 4: 1.53, 5: 1.92, 6: 1.70, 7: 1.55, 8: 1.52, 9: 1.47, 10: 1.54,
    11: 2.27, 12: 1.73, 13: 1.84, 14: 2.10, 15: 1.80, 16: 1.80, 17: 1.75, 18: 1.88, 19: 2.75, 20: 2.31,
    21: 2.30, 22: 2.15, 23: 2.05, 24: 2.05, 25: 2.05, 26: 2.05, 27: 2.00, 28: 2.00, 29: 2.00, 30: 2.10,
    31: 1.87, 32: 2.11, 33: 1.85, 34: 1.90, 35: 1.83, 36: 2.02, 37: 3.03, 38: 2.49, 39: 2.40, 40: 2.30,
    41: 2.15, 42: 2.10, 43: 2.05, 44: 2.05, 45: 2.00, 46: 2.05, 47: 2.10, 48: 2.20, 49: 2.20, 50: 1.93,
    51: 2.17, 52: 2.06, 53: 1.98, 54: 2.16, 55: 3.43, 56: 2.68, 57: 2.50, 58: 2.48, 59: 2.47, 60: 2.45,
    61: 2.43, 62: 2.42, 63: 2.40, 64: 2.38, 65: 2.37, 66: 2.35, 67: 2.33, 68: 2.32, 69: 2.30, 70: 2.28,
    71: 2.27, 72: 2.25, 73: 2.20, 74: 2.10, 75: 2.05, 76: 2.00, 77: 2.00, 78: 2.05, 79: 2.10, 80: 2.05,
    81: 1.96, 82: 2.02, 83: 2.07, 84: 1.97, 85: 2.02, 86: 2.20, 87: 3.48, 88: 2.83, 89: 2.00, 90: 2.40,
    91: 2.00, 92: 2.30, 93: 2.00, 94: 2.00, 95: 2.00, 96: 2.00, 97: 2.00, 98: 2.00, 99: 2.00, 100: 2.00,
    101: 2.00, 102: 2.00, 103: 2.00, 104: 2.00, 105: 2.00, 106: 2.00, 107: 2.00, 108: 2.00, 109: 2.00 }


# Ang (ESP fitting, jaguar manual)
r_esp = { 0: 1.597, 1: 1.597, 2: 1.181, 3: 1.226, 4: 1.373, 5: 2.042, 6: 1.949, 7: 1.831, 8: 1.702, 9: 1.736,
    10: 1.736, 11: 2.308, 12: 2.308, 13: 2.308, 14: 2.217, 15: 2.147, 16: 2.070, 17: 1.958, 18: 1.958,
    19: 1.906, 20: 1.700, 21: 1.647, 22: 1.587, 23: 1.572, 24: 1.511, 25: 1.480, 26: 1.456, 27: 1.436,
    28: 1.417, 29: 1.748, 30: 1.381, 31: 2.192, 32: 2.140, 33: 2.115, 34: 2.103, 35: 2.095, 36: 2.071,
    37: 2.057, 38: 1.821, 39: 1.673, 40: 1.562, 41: 1.583, 42: 1.526, 43: 1.499, 44: 1.481, 45: 1.464,
    46: 1.450, 47: 1.574, 48: 1.424, 49: 2.232, 50: 2.196, 51: 2.210, 52: 2.235, 53: 2.250, 54: 2.202,
    55: 2.259, 56: 1.851, 57: 1.761, 58: None, 59: None, 60: None, 61: None, 62: None, 63: None,
    64: None, 65: None, 66: None, 67: None, 68: None, 69: None, 70: None, 71: None, 72: 1.570, 73: 1.585,
    74: 1.534, 75: 1.477, 76: 1.560, 77: 1.420, 78: 1.377, 79: 1.647, 80: 1.353, 81: 2.174, 82: 2.148,
    83: 2.185, 84: None, 85: None, 86: None, 87: None, 88: None, 89: None, 90: None, 91: None, 92: None,
    93: None, 94: None, 95: None, 96: None, 97: None, 98: None, 99: None, 100: None, 101: None, 102: None,
    103: None, 104: None, 105: None, 106: None, 107: None, 108: None, 109: None }


# Ang (covalent radii)
r_cov = { 0: 0.31, 1: 0.31, 2: 0.28, 3: 1.28, 4: 0.96, 5: 0.84, 6: 0.76, 7: 0.71, 8: 0.66, 9: 0.57, 10: 0.58,
    11: 1.66, 12: 1.41, 13: 1.21, 14: 1.11, 15: 1.07, 16: 1.05, 17: 1.02, 18: 1.06, 19: 2.03, 20: 1.76,
    21: 1.70, 22: 1.60, 23: 1.53, 24: 1.39, 25: 1.39, 26: 1.32, 27: 1.26, 28: 1.24, 29: 1.32, 30: 1.22,
    31: 1.22, 32: 1.20, 33: 1.19, 34: 1.20, 35: 1.20, 36: 1.16, 37: 2.20, 38: 1.95, 39: 1.90, 40: 1.75,
    41: 1.64, 42: 1.54, 43: 1.47, 44: 1.46, 45: 1.42, 46: 1.39, 47: 1.45, 48: 1.44, 49: 1.42, 50: 1.39,
    51: 1.39, 52: 1.38, 53: 1.39, 54: 1.40, 55: 2.44, 56: 2.15, 57: 2.07, 58: 2.04, 59: 2.03, 60: 2.01,
    61: 1.99, 62: 1.98, 63: 1.98, 64: 1.96, 65: 1.94, 66: 1.92, 67: 1.92, 68: 1.89, 69: 1.90, 70: 1.87,
    71: 1.87, 72: 1.75, 73: 1.70, 74: 1.62, 75: 1.51, 76: 1.44, 77: 1.41, 78: 1.36, 79: 1.36, 80: 1.32,
    81: 1.45, 82: 1.46, 83: 1.48, 84: 1.40, 85: 1.50, 86: 1.50, 87: 2.60, 88: 2.21, 89: 2.15, 90: 2.06,
    91: 2.00, 92: 1.96, 93: 1.90, 94: 1.87, 95: 1.80, 96: 1.69, 97: 1.60, 98: 1.60, 99: 1.60, 100: 1.60,
    101: 1.60, 102: 1.60, 103: 1.60, 104: 1.60, 105: 1.60, 106: 1.60, 107: 1.60, 108: 1.60, 109: 1.60 }


# Ang (solvation radii)
r_sol = { 0: 1.20, 1: 1.20, 2: 1.40, 3: 1.82, 4: 1.70, 5: 2.08, 6: 1.95, 7: 1.85, 8: 1.70, 9: 1.73, 10: 1.54,
     11: 2.27, 12: 1.73, 13: 2.05, 14: 2.10, 15: 2.08, 16: 2.00, 17: 1.97, 18: 1.88, 19: 2.75, 20: 1.97,
     21: 1.70, 22: 1.70, 23: 1.70, 24: 1.70, 25: 1.70, 26: 1.70, 27: 1.70, 28: 1.63, 29: 1.40, 30: 1.39,
     31: 1.87, 32: 1.70, 33: 1.85, 34: 1.90, 35: 2.10, 36: 2.02, 37: 1.70, 38: 1.70, 39: 1.70, 40: 1.70,
     41: 1.70, 42: 1.70, 43: 1.70, 44: 1.70, 45: 1.70, 46: 1.63, 47: 1.72, 48: 1.58, 49: 1.93, 50: 2.17,
     51: 2.20, 52: 2.06, 53: 2.15, 54: 2.16, 55: 1.70, 56: 1.70, 57: 1.70, 58: 1.70, 59: 1.70, 60: 1.70,
     61: 1.70, 62: 1.70, 63: 1.70, 64: 1.70, 65: 1.70, 66: 1.70, 67: 1.70, 68: 1.70, 69: 1.70, 70: 1.70,
     71: 1.70, 72: 1.70, 73: 1.70, 74: 1.70, 75: 1.70, 76: 1.70, 77: 1.70, 78: 1.72, 79: 1.66, 80: 1.55,
     81: 1.96, 82: 2.02, 83: 1.70, 84: 1.70, 85: 1.70, 86: 1.70, 87: 1.70, 88: 1.70, 89: 1.70, 90: 1.70,
     91: 1.70, 92: 1.86, 93: 1.70, 94: 1.70, 95: 1.70, 96: 1.70, 97: 1.70, 98: 1.70, 99: 1.70, 100: 1.70,
    101: 1.70, 102: 1.70, 103: 1.70, 104: 1.70, 105: 1.70, 106: 1.70, 107: 1.70, 108: 1.70, 109: 1.70 }


# eV / Filimovov et al. [10.1080/10629360903438370]
ionpot = { 0: 13.60, 1: 13.60, 2: 24.59, 3: 5.39, 4: 9.32, 5: 8.30, 6: 11.26, 7: 14.53, 8: 13.62, 9: 17.42, 10: 21.57,
    11: 5.14, 12: 7.64, 13: 5.99, 14: 8.15, 15: 10.49, 16: 10.36, 17: 12.97, 18: 15.76, 19: 4.34, 20: 6.11,
    21: 6.56, 22: 6.82, 23: 6.74, 24: 6.77, 25: 7.43, 26: 7.90, 27: 7.86, 28: 7.64, 29: 7.72, 30: 9.39,
    31: 6.00, 32: 7.90, 33: 9.79, 34: 9.75, 35: 11.81, 36: 14.00, 37: 4.18, 38: 5.69, 39: 6.22, 40: 6.84,
    41: 6.88, 42: 7.09, 43: 7.23, 44: 7.37, 45: 7.46, 46: 8.34, 47: 7.58, 48: 8.99, 49: 5.79, 50: 7.34,
    51: 8.64, 52: 9.01, 53: 10.45, 54: 12.13, 55: 3.89, 56: 5.21, 57: 5.59, 58: 5.54, 59: 5.47, 60: 5.53,
    61: 5.58, 62: 5.64, 63: 5.67, 64: 6.15, 65: 5.86, 66: 5.94, 67: 6.02, 68: 6.11, 69: 6.18, 70: 6.25,
    71: 6.15, 72: 7.50, 73: 7.89, 74: 7.98, 75: 7.88, 76: 8.73, 77: 9.10, 78: 8.96, 79: 9.23, 80: 10.44,
    81: 6.11, 82: 7.42, 83: 7.29, 84: 8.42, 85: 9.20, 86: 10.75, 87: 3.98, 88: 5.28, 89: 5.20, 90: 6.10,
    91: 6.00, 92: 6.19, 93: 6.20, 94: 6.06, 95: 6.00, 96: 6.09, 97: 6.23, 98: 6.27, 99: 6.47, 100: 6.60,
    101: 6.68, 102: 6.58, 103: 6.69, 104: None, 105: 6.43, 106: None, 107: None, 108: None, 109: None }


# eV / Filimovov et al. [10.1080/10629360903438370] / Myers [10.1021/ed067p307]
eafin = { 0: 0.75, 1: 0.75, 2: 0.08, 3: 0.62, 4: -0.20, 5: 0.28, 6: 1.26, 7: 0.44, 8: 1.46, 9: 3.45, 10: 0.00,
    11: 0.55, 12: -0.31, 13: 0.30, 14: 1.39, 15: 0.75, 16: 2.00, 17: 3.61, 18: -0.37, 19: 0.50, 20: -0.19,
    21: 0.19, 22: 0.33, 23: 0.53, 24: 0.67, 25: -0.17, 26: 0.50, 27: 0.66, 28: 1.16, 29: 1.23, 30: -0.44,
    31: 0.30, 32: 1.39, 33: 0.80, 34: 2.02, 35: 3.45, 36: -0.42, 37: 0.49, 38: -0.15, 39: 0.31, 40: 0.33,
    41: 0.51, 42: 0.68, 43: 0.54, 44: 1.10, 45: 1.14, 46: 1.11, 47: 1.22, 48: -0.43, 49: 0.31, 50: 1.39,
    51: 0.90, 52: 1.97, 53: 3.23, 54: -0.25, 55: 0.47, 56: -0.15, 57: 0.30, 58: 0.25, 59: 0.20, 60: 0.20,
    61: 0.20, 62: 0.20, 63: 0.20, 64: 0.20, 65: 0.20, 66: 0.20, 67: 0.20, 68: 0.20, 69: 0.20, 70: 0.20,
    71: 0.20, 72: 0.33, 73: 0.40, 74: 0.67, 75: 0.23, 76: 1.44, 77: 1.57, 78: 1.10, 79: 1.25, 80: -0.19,
    81: 0.31, 82: 1.39, 83: 0.97, 84: 1.97, 85: 2.90, 86: -0.15, 87: 0.48, 88: -0.15, 89: 0.80, 90: 0.80,
    91: 0.84, 92: 0.82, 93: 0.82, 94: 0.84, 95: 0.85, 96: 0.85, 97: 0.82, 98: 0.84, 99: 0.86, 100: 0.86,
    101: 0.83, 102: 0.79, 103: 0.85, 104: None, 105: 0.46, 106: None, 107: None, 108: None, 109: None }
    

symbol  = { 0 : "X", 1 : "H", 2 : "He", 3 : "Li", 4 : "Be", 5 : "B", 6 : "C", 7 : "N", 8 : "O", 9 : "F", 10 : "Ne",
    11 : "Na", 12 : "Mg", 13 : "Al", 14 : "Si", 15 : "P", 16 : "S", 17 : "Cl", 18 : "Ar", 19 : "K", 20 : "Ca",
    21 : "Sc", 22 : "Ti", 23 : "V", 24 : "Cr", 25 : "Mn", 26 : "Fe", 27 : "Co", 28 : "Ni", 29 : "Cu", 30 : "Zn",
    31 : "Ga", 32 : "Ge", 33 : "As", 34 : "Se", 35 : "Br", 36 : "Kr", 37 : "Rb", 38 : "Sr", 39 : "Y", 40 : "Zr",
    41 : "Nb", 42 : "Mo", 43 : "Tc", 44 : "Ru", 45 : "Rh", 46 : "Pd", 47 : "Ag", 48 : "Cd", 49 : "In", 50 : "Sn",
    51 : "Sb", 52 : "Te", 53 : "I", 54 : "Xe", 55 : "Cs", 56 : "Ba", 57 : "La", 58 : "Ce", 59 : "Pr", 60 : "Nd",
    61 : "Pm", 62 : "Sm", 63 : "Eu", 64 : "Gg", 65 : "Tb", 66 : "Dy", 67 : "Ho", 68 : "Er", 69 : "Tm", 70 : "Yb",
    71 : "Lu", 72 : "Hf", 73 : "Ta", 74 : "W", 75 : "Re", 76 : "Os", 77 : "Ir", 78 : "Pt", 79 : "Au", 80 : "Hg",
    81 : "Tl", 82 : "Pb", 83 : "Bi", 84 : "Po", 85 : "At", 86 : "Rn", 87 : "Fr", 88 : "Ra", 89 : "Ac", 90 : "Th",
    91 : "Pa", 92 : "U", 93 : "Np", 94 : "Pu", 95 : "Am", 96 : "Cm", 97 : "Bk", 98 : "Cf", 99 : "Es", 100 : "Fm",
    101 : "Md", 102 : "No", 103 : "Lr", 104 : "Rf", 105 : "Db", 106 : "Sg", 107 : "Bh", 108 : "Hs", 109 : "Mt" }



rsymbol = {}
for k in iter( symbol ):
    rsymbol[symbol[k]] = k



def calc_mass( formula = "H2O1" ):
    o = 0.0
    for i,j in re.compile( "([a-zA-Z]+)([0-9\.]+)" ).findall( formula ):
        o += float( j ) * mass[rsymbol[i.title()]]
    return( o )


